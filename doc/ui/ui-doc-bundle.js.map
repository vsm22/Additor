{"version":3,"sources":["webpack:///webpack/bootstrap 591baa2909596fa6ad75","webpack:///./src/util/constraint.js","webpack:///./src/util/constraint-def.js","webpack:///./src/ui/core/widget.js","webpack:///./src/util/util-math.js","webpack:///./src/ui/core/widget-mixin-svgns.js","webpack:///./src/ui/core/widget-mixin-state.js","webpack:///./src/ui/core/widget-mixin-options.js","webpack:///./src/ui/core/widget-mixin-observer.js","webpack:///./src/ui/dial.js","webpack:///./src/ui/slider.js","webpack:///./src/ui/graph.js","webpack:///./src/ui/numberbox.js","webpack:///./src/ui/keyboard.js","webpack:///./src/ui/dropmenu.js","webpack:///./src/ui/multislider.js","webpack:///./src/ui/meter.js","webpack:///./doc/ui/ui-doc.js"],"names":["Constraint","spec","min","max","enum","transform","ConstraintSpec","specDefObj","constraintMap","_parseMap","targetObj","_this","forEach","_constrainBranch","keyBranch","target","constraint","key","undefined","Math","Array","find","c","cMap","push","Object","parentBranch","map","x","keys","keyIdx","newKeyBranch","curKey","length","arrFlag","i","keyBranchSlice","slice","j","_applyConstraint","Widget","container","o","Element","Error","svg","document","createElementNS","SVG_NS","appendChild","setAttribute","getBoundingClientRect","width","height","svgEls","handlers","state","stateConstraints","observers","_initOptions","_initStateConstraints","_initState","_initSvgEls","_initHandlers","values","appendSvgEls","svgEl","child","arrEl","newVal","newState","_getLeft","y","_getTop","top","left","assign","prototype","MathUtil","getPrecision","val","decStr","split","round","precision","factor","pow","quantize","q","qVal","abs","WidgetStateMixin","getState","setInternalState","isChanged","hasOwnProperty","constrain","_update","setState","_notifyObservers","WidgetOptionsMixin","getOptions","setOptions","WidgetObserverMixin","addObserver","newObserver","observer","removeObserver","targetObserver","idx","splice","addListener","newListener","removeListener","targetListener","getVal","Dial","stepPrecision","step","minVal","maxVal","needleColor","activeColor","mouseSensitivity","num","bgArc","activeArc","needle","_calcSvgArcPath","_calcNeedleCenter","_calcDialRadius","PI","_calcArcStrokeWidth","_calcNeedleEnd","_calcNeedleWidth","_appendSvgEls","y0","yD","touch","ev","clientY","addEventListener","move","release","preventDefault","_calcMovePrecision","removeEventListener","_calcNeedleAngle","radius","_getWidth","_getHeight","trunc","sin","cos","cx","cy","r","startAngle","endAngle","x1","y1","x2","y2","largeArc","sweep","join","Slider","sliderBodyColor","sliderHandleColor","dims","offsetBottom","offsetTop","bodyWidth","handleWidth","handleHeight","body","overlay","handle","touchBody","stopPropagation","_calcTouchVal","touchHandle","moveHandle","releaseHandle","sliderBodyPos","_calcSliderBodyPos","_calcSliderBodyHeight","sliderHandlePoints","_calcSliderHandlePoints","sliderBodyHeight","x0","valRange","bodyY","_getRelativeY","touchVal","Graph","vertices","vtx","vertexArray","xyPair","newVtx","minXVal","minYVal","isXFixed","isYFixed","xAnchor","yAnchor","maxXVal","maxYVal","newVertices","sort","a","b","addVertex","maxNumVertices","quantizeX","quantizeY","xDecimalPrecision","yDecimalPrecision","isEditable","vertexColor","fixedVertexColor","lineColor","backgroundColor","vertexRadius","lineWidth","panel","lines","targetVtx","targetLine","vtxPos0","dx","dy","touchPanel","xPos","clientX","yPos","vertexState","_calcVertexState","touchVertex","moveVertex","deleteVertex","touchLine","moveLine","endMoveLine","dPos","_moveLine","_deleteVertex","endMoveVertex","_moveVertex","line","idxSortMap","el","_addSvgVertex","_removeSvgVertex","stateVtx","svgVtx","pos","_calcVertexPos","vtxFill","prevVtx","prevPos","removeChild","svgLine","vtxIdx","findIndex","isRemovable","newVertex","_addSvgLine","newLine","vertex","pop","_removeSvgLine","lineIdx","vtx1","vtx2","vtx1curPos","parseInt","getAttribute","vtx2curPos","boundaryBL","boundaryTR","vtx1newPos","vtx2newPos","newPos","vtxState","vertexPos","Numberbox","quantizeInterval","fontColor","fontSize","fontFamily","appendString","valConstraintDef","console","log","toFixed","text","textContent","panelWidth","panelHeight","textWidth","textHeight","Keyboard","bottomNote","_isWhiteKey","topNote","lastNoteEvent","activeNotes","note","pitch","vel","newNote","isVelToggled","_getNewStateFromNewNote","keyBorderColor","blackKeyColor","whiteKeyColor","blackKeyActiveColor","whiteKeyActiveColor","blackKeyHeightAspect","blackKeyWidthAspect","mode","orientation","numKeys","_getNumKeys","_addSvgKey","_removeSvgKey","touchVel","ceil","_getKeyboardHeight","_touchKey","targetKey","setVal","fill","stroke","blackKeys","notes","activeNote","_updateSvgEls","whiteKeyIdx","_getPitchForKeyIdx","attr","_getWhiteKeyWidth","_setKeyAttributes","noteIdx","newKey","whiteKeyCount","curNote","_getKeyboardWidth","_getNumWhiteKeys","Dropmenu","selectedItemIdx","menuItems","itemIdx","item","menuItem","menuItemFontSize","menuItemFontFamily","menuItemVerticalPadding","menuItemHorizontalPadding","selectedItemBackgroundColor","selectedItemFontColor","hasFocus","menuTogglePanel","menuToggleText","menuToggleOverlay","menuBodyCanvasContainer","createElement","menuBodyCanvas","menuBodyPanel","menuItemPanels","menuItemTextboxes","menuItemOverlays","style","position","focus","blur","mouseOverItem","targetOverlay","_mouseOverItem","mouseLeaveItem","select","_mouseLeaveItem","hoverOut","_selectItem","_updateEls","display","menuItemDims","_calcMenuItemDims","menuDims","curPanel","curTextbox","curOverlay","_addSvgMenuItem","_removeSvgMenuItem","targetPanel","targetTextbox","newItemText","newItemPanel","newItemOverlay","targetItemTexbox","targetItemPanel","targetItemOverlay","maxHeight","maxWidth","bbox","Multislider","numSliders","sliderColors","sliderVals","sliders","sliderPanels","_setSliderVal","sliderPos","_calcSliderPos","_calcSliderWidth","_calcSliderHeight","_addSvgSlider","_removeSvgSlider","newSliderVals","newSlider","newSliderPanel","targetSlider","targetSliderPanel","targetIdx","sliderPanel","Meter","audioCtx","_initCanvasElements","_initAudioModules","initAmplitude","amplitude","prevAmplitude","peak","peakSetTime","currentTime","scriptProcessor","createScriptProcessor","connect","destination","onaudioprocess","e","_calcAmplitude","inputBuffer","getChannelData","_calcPeak","input","canvas","ctx","getContext","containerDims","ledGradient","createLinearGradient","addColorStop","redraw","ledHeight","peakYPos","clearRect","fillStyle","fillRect","window","requestAnimationFrame","audioSource","buffer","sum","sqrt","dialContainer","getElementById","dialDisplay","nextElementSibling","dial","innerHTML","envelopeGraphContainer","envelopeGraphDisplay","envelopeGraph","keyboardContainer","keyboardDisplay","keyboard","getActiveNotes","an","multisliderContainer","multisliderDisplay","multislider","sliderContainer","sliderDisplay","slider","sliderVal","meterContainer","meterDisplay","AudioContext","meter","osc","createOscillator","lfo1","lfo2","amp1","createGain","amp2","amp3","frequency","value","gain","receiveAudioFrom","start","dropmenuContainer","dropmenuDisplay","dropmenu","setMenuItems","selectedItem","numberboxContainer","numberboxDisplay","numberbox"],"mappings":"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","file":"/doc/ui/ui-doc-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 47);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 591baa2909596fa6ad75","/**\n * @class\n * Constraint object represents constraints on a value.\n * Instances of Constraint are used as leaves on a ConstraintSpec definition.\n * A ConstraintSpec useses Constraints to apply a constraint to leaves of an\n * arbitrarily nested object, whose leaves represent values that may be constrained.\n */\nclass Constraint {\n\n  /**\n   * @constructor\n   * @param {object} [spec] - Spec specifying the constraints.\n   * @param {number} [spec.min] - Minimum value.\n   * @param {number} [spec.max] - Maximum value.\n   * @param {array} [spec.enum] - Array of possible enumerable values.\n   * @param {function} [spec.transform] - A transformation function to apply to the value.\n   */\n  constructor(spec) {\n    spec = spec || {};\n\n    this.min = spec.min;\n    this.max = spec.max;\n    this.enum = spec.enum;\n    this.transform = spec.transform;\n  }\n}\n\nexport default Constraint;\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/constraint.js","import Constraint from \"./constraint\";\n\n/**\n * ConstraintSpec is used to apply a constraining function to a state object of arbitrary nestedness,\n * whose leaves are values that need to be constrained (i.e. to min or max values).\n * In order for ConstraintSpec to work properly, it's constructor must be given an object that\n * exactly mirrors the nested structure of the object to be constrained, with the leaves\n * containing instances of the Constraint class. Additional requirements (i.e. how to deal with nested arrays)\n * are outlined below.\n * TODO: expand explanation\n *\n * @class\n */\nclass ConstraintSpec {\n\n  /**\n   * @constructor\n   * @param {object} specDefObj - The constraint spec definition object, which defines the nesting\n   *                              structure of the objects that need to be constrained. The leaves\n   *                              of this specDef object must be objects of type Constraint, which\n   *                              act as the constraint definitions for each leaf.\n   */\n  constructor(specDefObj) {\n    this.constraintMap = [[]];\n    this._parseMap(specDefObj, this.constraintMap[0], this.constraintMap);\n  }\n\n  /**\n   * Check a constraint map for constraint specs and apply them to obj.\n   * Note: will not mutate the original object. New value is returned.\n   * @public\n   * @param {object} targetObj - The state object to check\n   * @return {number | string | object | array} val - The constrained value.\n   */\n  constrain(targetObj) {\n    const _this = this;\n    _this.constraintMap.forEach(keyBranch => {\n      _this._constrainBranch(targetObj, keyBranch);\n    });\n  }\n\n  /**\n   * Apply a constraint.\n   * @private\n   * @param {object} target - The target object to constrain\n   * @param {Constraint} constraint - The constraint object to use.\n   * @param {symbol} key - The key to use to access the constraint.\n   * @return {number | string | object | array} val - The constrained value.\n   */\n  _applyConstraint(target, constraint, key) {\n    if (constraint.min !== undefined) {\n      target[key] = Math.max(target[key], constraint.min);\n    }\n    if (constraint.max !== undefined) {\n      target[key] = Math.min(target[key], constraint.max);\n    }\n    if (constraint.enum !== undefined && constraint.enum instanceof Array) {\n      target[key] = (constraint.enum.find(target[key]) !== undefined) ? target[key] : constraint.enum[0];\n    }\n    if (constraint.transform !== undefined && typeof constraint.transform === \"function\") {\n      target[key] = constraint.transform(target[key]);\n    }\n\n    return target;\n  }\n\n  /**\n   * Parse a constraint map\n   * @private\n   * @param {object} c - The map object currently being examined.\n   *                     At the top level, this would be the whole map.\n   *                     At the terminal level, this would be an instance of Constraint object.\n   * @param {array} keyBranch - An array of keys that will specify how to get to each Constraint.\n   *                            The last element in this array will be the constraint itself.\n   * @param {array} cMap - An mutable array of key branches.\n   */\n  _parseMap(c, keyBranch, cMap) {\n    const _this = this;\n\n    if (c instanceof Array) {\n      /* if c is an array, add \"_arr_\" to the current map, and examine the first element.\n       * all elements in an array are required to have identical structure, so examining\n       * the first one is enough.\n       */\n      keyBranch.push(\"_arr_\");\n      _this._parseMap(c[0], keyBranch, cMap);\n    } else if (c instanceof Object && !(c instanceof Constraint)) {\n      // keep a copy of the parent branch to create new branches from\n      let parentBranch = keyBranch.map(x=>x);\n\n      // create new branch for each key after the first key using the parentBranch clone\n      Object.keys(c).forEach((key, keyIdx) => {\n        if (keyIdx === 0) {\n          keyBranch.push(key);\n          _this._parseMap(c[key], keyBranch, cMap);\n        } else {\n          let newKeyBranch = parentBranch.map(x=>x);\n          cMap.push(newKeyBranch);\n          newKeyBranch.push(key);\n          _this._parseMap(c[key], newKeyBranch, cMap);\n        }\n      });\n    } else if (c instanceof Constraint) {\n\n      // this will be the last element in the branch - the Constraint object itself\n      keyBranch.push(c);\n    }\n  }\n\n  /**\n   * Apply constraints to one branch of the constraint map.\n   * @private\n   * @param {object} targetObj - The state object to apply the constraint to\n   * @param {object} defObj - The constraint definition object to use.\n   * @param {array} keyBranch - An array of keys representing a path to a constraint object.\n   */\n  _constrainBranch(targetObj, keyBranch) {\n    const _this = this;\n\n    let curKey;\n    let constraint = keyBranch[keyBranch.length - 1];\n    let arrFlag = false;\n\n    /* Drill into targetObj and defObj following keyBranch keys\n     * We go to length - 2, because the next-to-last element might be an\n     * array, and the last element is the Constraint object itself.\n     */\n    for (let i = 0; i < keyBranch.length - 2 && !arrFlag; ++i) {\n      curKey = keyBranch[i];\n\n      // if we encounter an array, drill into each corresponding arry element in targetObj\n      if (curKey === \"_arr_\") {\n        arrFlag = true;\n\n        let keyBranchSlice = keyBranch.slice(i + 1, keyBranch.length);\n\n        for (let j = 0; j < targetObj.length; ++j) {\n          _this._constrainBranch(targetObj[j], keyBranchSlice);\n        }\n      } else {\n        targetObj = targetObj[curKey];\n      }\n    }\n\n    // if arrFlag is set, we've encountered an array somewhere other than on the leaves\n    // in this case we don't need to operate on it\n    if (!arrFlag) {\n      // Apply the constraints\n      curKey = keyBranch[keyBranch.length - 2];\n\n      if (curKey === \"_arr_\") {\n        for (let i = 0; i < targetObj.length; ++i) {\n          _this._applyConstraint(targetObj, constraint, i);\n        }\n      } else {\n        _this._applyConstraint(targetObj, constraint, curKey);\n      }\n    }\n  }\n}\n\nexport default ConstraintSpec;\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/constraint-def.js","import WidgetSvgNsMixin from \"./widget-mixin-svgns\";\nimport WidgetStateMixin from \"./widget-mixin-state\";\nimport WidgetOptionsMixin from \"./widget-mixin-options\";\nimport WidgetObserverMixin from \"./widget-mixin-observer\";\n\n'use strict';\n\n/**\n * Abstract base class representing an SVG widget that can be placed inside a DOM container.\n * @class\n * @abstract\n */\nclass Widget {\n\n  /**\n   * @constructor\n   * @mixes WidgetSvgNsMixin\n   * @mixes WidgetStateMixin\n   * @mixes WidgetOptionsMixin\n   * @mixes WidgetObserverMixin\n   * @param {DOM element} container - DOM element that will contain the widget.\n   * @param {object=} o - Options.\n   */\n  constructor(container, o) {\n    if (container === undefined || !(container instanceof Element)) {\n      throw new Error(\"widget requires a DOM element specifying its container as the first argument\");\n    }\n\n    this.container = container;\n\n    o = o || {};\n\n    this.svg = document.createElementNS(this.SVG_NS, \"svg\");\n    this.container.appendChild(this.svg);\n    this.svg.setAttribute(\"width\", this.container.getBoundingClientRect().width);\n    this.svg.setAttribute(\"height\", this.container.getBoundingClientRect().height);\n\n    /* Manifest of containers and namespaces */\n    this.o = {};                 // options namespace\n    this.svgEls = {};            // svg element namespace\n    this.handlers = {};          // mouse and touch event handler namespace\n    this.state = {};             // state namespace\n    this.stateConstraints = {};  // state constraints namespace\n    this.observers = [];         // observer callback container\n\n    this._initOptions(o);\n    this._initStateConstraints();\n    this._initState();\n    this._initSvgEls();\n    this._initHandlers();\n  }\n\n  /**\n   * Initialize the options\n   * @abstract\n   * @protected\n   */\n  _initOptions(o) {}\n\n  /**\n   * Initialize state constraints\n   * @abstract\n   * @protected\n   */\n  _initStateConstraints() {}\n\n  /**\n   * Initialize state\n   * @abstract\n   * @protected\n   */\n  _initState() {}\n\n  /**\n   * Initialize the svg elements.\n   * Each implementation of this method must end with calls to _appendSvgEls() and _update(),\n   * in that order, as shown in this template\n   * @abstract\n   * @protected\n   */\n  _initSvgEls() {}\n\n  /**\n   * Append the newly created svg elements to the svg container.\n   * This method should be called exctly once by each implementation of the _initSvgEls() method.\n   * @protected\n   */\n  _appendSvgEls() {\n    const _this = this;\n\n    Object.values(_this.svgEls).forEach(svgEl => {\n      appendSvgEls(svgEl);\n    });\n\n    function appendSvgEls(child) {\n      if (child instanceof Array) {\n        child.forEach(arrEl => appendSvgEls(arrEl));\n      } else {\n        _this.svg.appendChild(child);\n        child.setAttribute(\"shape-rendering\", \"geometricPrecision\");\n      }\n    }\n  }\n\n  /**\n   * Initialize mouse and touch event handlers\n   * @abstract\n   * @protected\n   */\n  _initHandlers() {}\n\n  /**\n   * Update (redraw) component based on state\n   * @abstract\n   * @protected\n   */\n  _update() {}\n\n  /* ===========================================================================\n  *  PUBLIC API\n  */\n\n  /**\n   * Get public representation of the state.\n   * @abstract\n   * @public\n   */\n  getVal() {}\n\n  /**\n   * Set the current state in a format specific to each widget.\n   * Same as setVal(), but will not cause an observer callback trigger.\n   * @abstract \n   * @public\n   */\n  setInternalVal(newVal) {}\n\n  /**\n   * Set the current state in a format specific to each widget.\n   * Same as setInternalVal(), but will cause an observer callback trigger.\n   * @abstract @public\n   */\n  setVal(newVal) {}\n\n  /**\n   * Get the current state.\n   * @abstract\n   * @public\n   * @returns {object} - Copy of this.state\n   */\n  getState() {}\n\n  /**\n   * Set the current state and redraw.\n   * @description If no new state argument is provided, will reassign old state, taking into account the stateConstraints.\n   * As opposed to setState(), setInternalState() does not trigger observer notification.\n   * Will use Widget.stateConstraints to constrain each state value to each constraints min, max, or enum\n   * @abstract\n   * @public\n   * @param {object} [newState] - The new state.\n   * @returns {boolean} A flag indicating whether the state has been changed.\n   */\n  setInternalState(newState) {}\n\n  /**\n   * Sets the current state and redraws.\n   * @description As opposed to setInternalState(), setState() will call the observer callback functions,\n   * so may lead to an infinate loop if an observer calls this method.\n   * @abstract\n   * @public\n   * @param {object} [newState] - The new state.\n   * @returns {boolean} A flag indicating whether the state has been changed.\n   */\n  setState(newState) {}\n  \n  /* ===========================================================================\n  *  HELPER METHODS\n  */\n\n  /** Helper method: get x relative to the container */\n  _getRelativeX(x) {\n    return x - this._getLeft();\n  }\n\n  /** Helper method: get y relative to the container */\n  _getRelativeY(y) {\n    return y - this._getTop();\n  }\n\n   /** Helper method: get the width of the svg container */\n   _getWidth() {\n     return this.svg.getBoundingClientRect().width;\n   }\n\n   /** Helper method: get the height of the svg container */\n   _getHeight() {\n     return this.svg.getBoundingClientRect().height;\n   }\n\n   /** Helper method: get the top edge position of the svg container */\n   _getTop() {\n     return this.svg.getBoundingClientRect().top;\n   }\n\n   /** Helper method: get the left edge position of the svg container */\n   _getLeft() {\n     return this.svg.getBoundingClientRect().left;\n   }\n}\n\nObject.assign(Widget.prototype, WidgetSvgNsMixin);\nObject.assign(Widget.prototype, WidgetStateMixin);\nObject.assign(Widget.prototype, WidgetOptionsMixin);\nObject.assign(Widget.prototype, WidgetObserverMixin);\n\nexport default Widget;\n\n\n// WEBPACK FOOTER //\n// ./src/ui/core/widget.js","/**\n * Useful Math Utility functions\n */\nlet MathUtil = {\n\n  /**\n   * Returns the decimal precision of a number.\n   * @param {number} val - The value whose precision to check.\n   * @returns {number} - Number of decimal places.\n   */\n  getPrecision(val) {\n    let decStr = (''+val).split('.')[1];\n    return (decStr ? decStr.length : 0);\n  },\n\n  /**\n   * Round a number to specified decimal precision.\n   * Same as Number.prototype.toFixed, but does not use toString.\n   * @param {nubmer} val - Value to be rounded.\n   * @param {precision} val - \n   * @returns  \n   */\n  round: function round(val, precision) {\n    let factor = Math.pow(10, precision);\n    return Math.round(val * factor) / factor;\n  },\n\n  /**\n   * Quantize a value (set it to the closest value matching the interval)\n   * Note: result will not necessarily reflect the same number of places of\n   * as the q input due to floating point arithmetic.\n   * @param {number} val - Value to quantize.\n   * @param {number} q - The quantization interval.\n   * @param {number} precision - The decimal precision of the result.\n   * @returns {number} qVal - Quantized val.\n   */\n  quantize: function quantize(val, q, precision) {\n    let qVal;\n\n    if (q == 0) {\n      return 0;\n    } else if (q < 0) {\n      q = Math.abs(q);\n    }\n\n    // quantize\n    qVal = ~~(val / q) * q;\n\n    qVal = Math.abs(val - qVal) > (q / 2) ? \n            qVal > 0 ? \n              qVal + q\n            : qVal - q\n          : qVal;\n\n    if (precision !== undefined) {\n      qVal = MathUtil.round(qVal, precision);\n    }\n\n    return qVal;\n  },\n\n  /**\n   * Alias for quantize(val, q)\n   * @param {number} val - Value to quantize\n   * @param {number} q - The quantization interval\n   * @param {number} precision - The decimal precision of the result.\n   * @returns {number} qVal - Quantized val\n   */\n  q: function q(val, q, precision) {\n    return MathUtil.quantize(val, q, precision);\n  }\n};\n\nexport default MathUtil;\n\n\n// WEBPACK FOOTER //\n// ./src/util/util-math.js","/**\n * Mixin specifying the xml namespace for SVG\n * @mixin\n */\nconst SVG_NS = { SVG_NS: \"http://www.w3.org/2000/svg\" };\n\nexport default SVG_NS;\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/core/widget-mixin-svgns.js","import Constraint from \"util/constraint\";\nimport ConstraintSpec from \"util/constraint-def\";\n\n/**\n * Mixin for methods related to state management\n * @mixin\n */\nlet WidgetStateMixin = {\n\n  /**\n   * Get the current state.\n   *\n   * @public\n   * @returns {object} - Copy of this.state\n   */\n  getState: function getState() {\n    return Object.assign({}, this.state);\n  },\n\n  /**\n   * Set the current state and redraw.\n   *\n   * @description If no new state argument is provided, will reassign old state, taking into account the stateConstraints.\n   * As opposed to setState(), setInternalState() does not trigger observer notification.\n   * Will use Widget.stateConstraints to constrain each state value to each constraints min, max, or enum\n   *\n   * @protected\n   * @param {object=} newState - The new state.\n   * @return {boolean} isChanged - Returns a boolean indicating whether the state has been changed\n   */\n  setInternalState: function setInternalState(newState) {\n    const _this = this;\n    let isChanged = false;\n\n    newState = newState || this.getState();\n\n    Object.keys(newState).forEach(key => {\n      if (_this.state.hasOwnProperty(key) && _this.state[key] !== newState[key]) {\n        _this.state[key] = newState[key];\n        isChanged = true;\n      }\n    });\n\n    _this.stateConstraints.constrain(_this.state);\n    this._update();\n\n    return isChanged;\n  },\n\n  /**\n   * Set the current state and redraw.\n   *\n   * @description As opposed to setInternalState(), setState() will call the observer callback functions,\n   * so may lead to an infinate loop if an observer calls this method.\n   *\n   * @protected\n   * @param {object=} newState - The new state.\n   * @return {boolean} isChanged - Returns a boolean indicating whether the state has been changed\n   */\n  setState: function setState(newState) {\n    const _this = this;\n    let isChanged = false;\n\n    isChanged = this.setInternalState(newState);\n\n    this._notifyObservers();\n\n    return isChanged;\n  }\n};\n\nexport default WidgetStateMixin;\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/core/widget-mixin-state.js","/**\n * Mixin for methods related to options\n * @mixin\n */\nlet WidgetOptionsMixin = {\n\n  /**\n   * Initializes the options.\n   * @private\n   * @param {object} o - Options.\n   */\n  _initOptions: function _initOptions(o) {\n    const _this = this;\n    o = o || {};\n\n    Object.keys(o).forEach(key => {\n      if (_this.o.hasOwnProperty(key) && _this.o[key] !== o[key]) {\n        _this.o[key] = o[key];\n      }\n    });\n  },\n\n  /**\n   * Get the options object\n   * @public\n   * @return {object} this.o - Options\n   */\n  getOptions: function getOptions() {\n    return Object.assign({}, this.o);\n  },\n\n  /**\n   * Set the options\n   * Uses a diffing function, so only specified keys that have new values will be changed\n   * @public\n   * @param {object} o - options\n   * @return {boolean} isChanged - Returns a boolean indicating whether any option has been changed\n   */\n  setOptions: function setOptions(o) {\n    const _this = this;\n    o = o || {};\n    let isChanged = false;\n\n    Object.keys(o).forEach(key => {\n      if (_this.o.hasOwnProperty(key) && _this.o[key] !== o[key]) {\n        _this.o[key] = o[key];\n        isChanged = true;\n      }\n    });\n\n    if (isChanged) {\n      this.setState();\n    }\n\n    return isChanged;\n  }\n};\n\nexport default WidgetOptionsMixin;\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/core/widget-mixin-options.js","/**\n * Mixin for methods related to observer callback support\n * @mixin\n */\nlet WidgetObserverMixin = {\n\n  /**\n   * Register a new observer function that will recieve the state value every time the state is updated.\n   * @public\n   * @param {function} newObserver - The new observer function to be notified every time the state changes.\n   * @return {boolean} isChanged - Indicates whether an observer was added.\n   */\n  addObserver: function addObserver(newObserver) {\n    let isChanged = false;\n\n    if (!(this.observers.find(observer => observer === newObserver))) {\n      this.observers.push(newObserver);\n      isChanged = true;\n    }\n\n    return isChanged;\n  },\n\n  /**\n   * Remove an observer function from being notified when the state changes.\n   * @public\n   * @param {function} targetObserver - The observer function to be removed.\n   * @return {boolean} isChanged - Indicates whether an observer has been removed\n   */\n  removeObserver: function removeObserver(targetObserver) {\n    const _this = this;\n    let isChanged = false;\n\n    this.observers.forEach((observer, idx) => {\n      if (observer === targetObserver) {\n        _this.observers.splice(idx, 1);\n        isChanged = true;\n      }\n    });\n\n    return isChanged;\n  },\n\n  /**\n   * Alias for addObserver. Registers a listener (observer) function.\n   * @param {function} newListener - The new listener (observer) function to be notified every time the state changes.\n   * @return {boolean} isChanged - Indicates whether an observer was added.\n   */\n  addListener: function addListener(newListener) {\n    this.addObserver(newListener);\n  },\n\n  /**\n   * Alias for removeObserver. Removes a listener (observer) function.\n   * @param {function} targetListener - The listener (observer) function to be removed.\n   * @return {boolean} isChanged - Indicates whether an observer has been removed\n   */\n  removeListener: function removeListener(targetListener) {\n    this.removeObserver(targetListener);\n  },\n\n  /**\n   * Notify all observers of new state\n   * @protected\n   */\n  _notifyObservers() {\n    const _this = this;\n    this.observers.forEach(observer => observer(_this.getVal()));\n  }\n};\n\nexport default WidgetObserverMixin;\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/core/widget-mixin-observer.js","import Widget from \"ui/core/widget\";\nimport Constraint from \"util/constraint\";\nimport ConstraintSpec from \"util/constraint-def\";\nimport MathUtil from \"util/util-math\";\n\n/**\n * Class representing an SVG Dial widget.\n * @class\n * @implements {Widget}\n */\nclass Dial extends Widget {\n\n  /**\n   * @constructor\n   * @param {object} container - DOM container for the widget.\n   * @param {object=} o - options.\n   * @param {number=0} o.minVal - Minimum value constraint.\n   * @param {number=127} o.maxVal - Maximum value constraint.\n   * @param {number=1} o.step - Interval of the steps in which the dial changes value. \n   * @param {string=\"#000\"} o.needleColor - Dial needle color.\n   * @param {string=\"#f40\"} o.activeColor - Dial active color.\n   */\n  constructor(container, o) {\n    super(container, o);\n  }\n\n  /* ===========================================================================\n  *  PUBLIC API\n  */\n\n  /**\n   * Returns the dial value.\n   * @public @override\n   * @returns {number} - Value of the dial.\n   */\n  getVal() {\n    return this.state.val;\n  }\n\n  /**\n   * Sets the dial value.\n   * Same as setVal(), but will not trigger observer callbacks.\n   * @public @override\n   * @param {number} newVal - The new value.\n   */\n  setInternalVal(newVal) {\n    this.setInternalState({ val: newVal });\n  }\n\n  /**\n   * Sets the dial value.\n   * Same as setInternalVal(), but will trigger observer callbacks.\n   * @public @override\n   * @param {number} newVal - The new value.\n   */\n  setVal(newVal) {\n    this.setState({ val: newVal });\n  }\n\n  /**\n   * Sets the options. \n   * @public @override\n   * @param {object} o - Options.\n   */\n  setOptions(o) {\n    super.setOptions(o);\n    this.o.stepPrecision = MathUtil.getPrecision(this.o.step);\n  }\n\n  /* ==============================================================================================\n  *  INITIALIZATION METHODS\n  */\n\n  /**\n   * Initializes the options.\n   * @override\n   * @private\n   */\n  _initOptions(o) {\n    // set the defaults\n    this.o = {\n      minVal: 0,\n      maxVal: 127,\n      step: 1,\n      needleColor: \"#414141\",\n      activeColor: \"#f40\",\n      mouseSensitivity: 1.2\n    };\n\n    // override defaults with provided options\n    super._initOptions(o);\n\n    // set the precision based on the step interval\n    this.o.stepPrecision =  MathUtil.getPrecision(this.o.step);\n  }\n\n  /**\n   * Initializes state constraints.\n   * @override\n   * @private\n   */\n  _initStateConstraints() {\n    const _this = this;\n\n    this.stateConstraints = new ConstraintSpec({\n      val: new Constraint({\n        min: _this.o.minVal,\n        max: _this.o.maxVal,\n        transform: num => MathUtil.quantize(num, _this.o.step, _this.o.stepPrecision)\n      })\n    });\n  }\n\n  /**\n   * Initializes state.\n   * @override\n   * @private\n   */\n  _initState() {\n    this.state = {\n      val: 0\n    };\n  }\n\n  /**\n   * Initializes the svg elements.\n   * @override\n   * @private\n   */\n  _initSvgEls() {\n    const _this = this;\n\n    this.svgEls = {\n      bgArc: document.createElementNS(this.SVG_NS, \"path\"),\n      activeArc: document.createElementNS(this.SVG_NS, \"path\"),\n      needle: document.createElementNS(this.SVG_NS, \"line\")\n    };\n\n    // draw the background arc\n    this.svgEls.bgArc.setAttribute(\"d\",\n      _this._calcSvgArcPath(\n        _this._calcNeedleCenter().x,\n        _this._calcNeedleCenter().y,\n        _this._calcDialRadius(),\n        0.67 * Math.PI,\n        2.35 * Math.PI\n    ));\n    this.svgEls.bgArc.setAttribute(\"stroke-width\", _this._calcArcStrokeWidth());\n    this.svgEls.bgArc.setAttribute(\"stroke\", _this.o.needleColor);\n    this.svgEls.bgArc.setAttribute(\"fill\", \"transparent\");\n    this.svgEls.bgArc.setAttribute(\"stroke-linecap\", \"round\");\n\n    // draw the active arc\n    this.svgEls.activeArc.setAttribute(\"stroke-width\", _this._calcArcStrokeWidth());\n    this.svgEls.activeArc.setAttribute(\"stroke\", _this.o.activeColor);\n    this.svgEls.activeArc.setAttribute(\"fill\", \"transparent\");\n    this.svgEls.activeArc.setAttribute(\"stroke-linecap\", \"round\");\n\n    // draw the needle\n    this.svgEls.needle.setAttribute(\"x1\", _this._calcNeedleCenter().x);\n    this.svgEls.needle.setAttribute(\"y1\", _this._calcNeedleCenter().y);\n    this.svgEls.needle.setAttribute(\"x2\", _this._calcNeedleEnd().x);\n    this.svgEls.needle.setAttribute(\"y2\", _this._calcNeedleEnd().y);\n    this.svgEls.needle.setAttribute(\"stroke-width\", _this._calcNeedleWidth());\n    this.svgEls.needle.setAttribute(\"stroke\", _this.o.needleColor);\n    this.svgEls.needle.setAttribute(\"z-index\", \"1000\");\n    this.svgEls.needle.setAttribute(\"stroke-linecap\", \"round\");\n\n    this._appendSvgEls();\n    this._update();\n  }\n\n  /**\n   * Initializes mouse and touch event handlers.\n   * @override\n   * @private\n   */\n   _initHandlers() {\n      const _this = this;\n\n      let y0 = 0;\n      let yD = 0;\n      let newVal = _this.getState().val;\n\n      this.handlers = {\n\n       touch: function(ev) {\n          y0 = ev.clientY;\n\n          document.addEventListener(\"mousemove\", _this.handlers.move);\n          document.addEventListener(\"touchmove\", _this.handlers.move);\n          document.addEventListener(\"mouseup\", _this.handlers.release);\n          document.addEventListener(\"touchend\", _this.handlers.release);\n        },\n\n        move: function(ev) {\n          ev.preventDefault();\n\n          yD = y0 - ev.clientY;\n          y0 = ev.clientY;\n\n          newVal = _this.state.val + (yD * _this.o.mouseSensitivity * _this._calcMovePrecision());\n          newVal = Math.max(newVal, _this.o.minVal);\n          newVal = Math.min(newVal, _this.o.maxVal);\n\n          _this.setState({\n            val: newVal\n          });\n        },\n\n        release: function() {\n          document.removeEventListener(\"mousemove\", _this.handlers.move);\n          document.removeEventListener(\"touchmove\", _this.handlers.move);\n        }\n      };\n\n      this.svg.addEventListener(\"mousedown\", _this.handlers.touch);\n      this.svg.addEventListener(\"touchstart\", _this.handlers.touch);\n   }\n\n  /**\n   * Updates (redraws) components based on state.\n   * @override\n   * @private\n   */\n   _update() {\n     // change the needle angle\n     this.svgEls.needle.setAttribute(\"x1\", this._calcNeedleCenter().x);\n     this.svgEls.needle.setAttribute(\"y1\", this._calcNeedleCenter().y);\n     this.svgEls.needle.setAttribute(\"x2\", this._calcNeedleEnd().x);\n     this.svgEls.needle.setAttribute(\"y2\", this._calcNeedleEnd().y);\n\n     // change the active arc length\n     this.svgEls.activeArc.setAttribute(\"d\",\n       this._calcSvgArcPath(\n         this._calcNeedleCenter().x,\n         this._calcNeedleCenter().y,\n         this._calcDialRadius(),\n         0.65 * Math.PI,\n         this._calcNeedleAngle() - 0.5 * Math.PI\n     ));\n\n     // if the value is at min, change the color to match needle color\n     // - otherwise the active part will be visible beneath the needle\n     if (this.state.val === this.o.minVal) {\n       this.svgEls.activeArc.setAttribute(\"stroke\", this.o.needleColor);\n     } else {\n       this.svgEls.activeArc.setAttribute(\"stroke\", this.o.activeColor);\n     }\n   }\n\n  /* ==============================================================================================\n  *  INTERNAL FUNCTIONALITY METHODS\n  */\n\n   /** \n    * Calcultes the stroke width for the background and active arcs.\n    * @private\n    * @returns {number} - Arc stroke width;\n    */\n   _calcArcStrokeWidth() {\n     return this._calcDialRadius() / 5;\n   }\n\n   /** \n    * Calculates the dial radius.\n    * @private\n    * @returns {number} - Radius of the dial.\n    */\n   _calcDialRadius() {\n     let radius = (Math.min(this._getWidth(), this._getHeight()) / 2) * 0.89;\n     radius = Math.trunc(radius);\n     return radius;\n   }\n\n   /** \n    * Calculates the needle angle for a given state val.\n    * @private\n    * @returns {number} - Angle of the needle.\n    */\n   _calcNeedleAngle() {\n     const _this = this;\n\n     return (\n              // protect against divide by 0:\n              ((this.o.maxVal - _this.o.minVal) !== 0) ?\n                  (  \n                    (_this.state.val - _this.o.minVal) / (_this.o.maxVal - _this.o.minVal) * (1.7 * Math.PI) + \n                    (1.15 * Math.PI)\n                  )  \n                : ( 0.5 * (1.7 * Math.PI) + (1.15 * Math.PI) )\n            );\n   }\n\n   /** \n    * Calculates the center of the needle.\n    * @private\n    * @returns {object} - {x, y} object representing the needle center coordinates.\n    */\n   _calcNeedleCenter() {\n     const _this = this;\n     return {\n       x: Math.trunc(_this._getWidth() / 2),\n       y: Math.trunc(_this._getHeight() / 2)\n     };\n   }\n\n   /** \n    * Calculates the position of end of the needle\n    * @private\n    * @returns {object} - {x, y} object representing the end of the needle. \n    */\n   _calcNeedleEnd() {\n     const _this = this;\n     return {\n       x: _this._calcNeedleCenter().x + (Math.sin(_this._calcNeedleAngle()) * _this._calcDialRadius()),\n       y: _this._calcNeedleCenter().y - (Math.cos(_this._calcNeedleAngle()) * _this._calcDialRadius())\n     };\n   }\n\n   /** \n    * Calculates the needle width.\n    * @private\n    * @returns {number} - The width of the needle in px.\n    */\n   _calcNeedleWidth() {\n     return this._calcDialRadius() / 5;\n   }\n\n   /** \n    * Calculates the path for an svg arc based on cx, cy, r, startAngle, endAngle.\n    * The input parameters are the way arcs are represented in HTML canvas.\n    * @private\n    * @param {number} cx - Center X.\n    * @param {number} cy - Center Y.\n    * @param {number} r - Radius.\n    * @param {number} startAngle - Start angle in radians.\n    * @param {number} endAngle - End angle in radians.\n    * @returns {string} - A string to be used for the arc path by an SVG arc object.\n    */\n   _calcSvgArcPath(cx, cy, r, startAngle, endAngle) {\n     let x1 = cx + (r * Math.cos(startAngle));\n     let y1 = cy + (r * Math.sin(startAngle));\n     let x2 = cx + (r * Math.cos(endAngle));\n     let y2 = cy + (r * Math.sin(endAngle));\n     let largeArc = (endAngle - startAngle) < Math.PI ? 0 : 1;\n     let sweep = (endAngle - startAngle) < Math.PI ? 1 : 1;\n\n     return [\"M\", x1, y1, \"A\", r, r, 0, largeArc, sweep, x2, y2].join(\" \");\n   }\n\n   /**\n    * Calculates the precision with which the state value changes when moved.\n    */\n   _calcMovePrecision() {\n     let precision = (this.o.maxVal - this.o.minVal) / 127;\n     return precision;\n   }\n}\n\nexport default Dial;\n\n\n// WEBPACK FOOTER //\n// ./src/ui/dial.js","import Widget from \"ui/core/widget\";\nimport Constraint from \"util/constraint\";\nimport ConstraintSpec from \"util/constraint-def\";\nimport MathUtil from \"util/util-math\";\n\n/**\n * Class representing a Slider widget.\n * @class\n * @implements {Widget}\n */\nclass Slider extends Widget {\n\n  /**\n   * @constructor\n   * @param {object} container - DOM container for the widget.\n   * @param {object} [o] - Options.\n   * @param {number} [o.minVal=0] - The minimum possible value the slider can represent.\n   * @param {number} [o.maxVal=127] - The maximum possible value teh slider can represent.\n   * @param {number} [o.step=1] - Step granularity.\n   * @param {string} [o.sliderBodyColor=\"#484848\"] - The color of the slider bar.\n   * @param {string} [o.sliderHandleColor=\"#484848\"] - The color of the triangle used as the slider's needle.\n   */\n  constructor(container, o) {\n    super(container, o);\n  }\n\n  /* ===========================================================================\n  *  INITIALIZATION METHODS\n  */\n\n  /**\n   * Initialize the options\n   * @override\n   * @protected\n   */\n  _initOptions(o) {\n    // set the defaults\n    this.o = {\n      minVal: 0,\n      maxVal: 127,\n      step: 1,\n      sliderBodyColor: \"#484848\",\n      sliderHandleColor: \"#484848\",\n      mouseSensitivity: 1.2\n    };\n\n    // override defaults with provided options\n    super._initOptions(o);\n\n    // set the precision (num of decimal places used) based on the step interval\n    this.o.stepPrecision =  MathUtil.getPrecision(this.o.step);\n  }\n\n  /**\n   * Initialize state constraints\n   * @override\n   * @protected\n   */\n  _initStateConstraints() {\n    const _this = this;\n\n    this.stateConstraints = new ConstraintSpec({\n      val: new Constraint({ \n        min: _this.o.minVal, \n        max: _this.o.maxVal, \n        transform: (num) => MathUtil.quantize(num, _this.o.step, _this.o.stepPrecision) \n      })   \n    });\n  }\n\n  /**\n   * Initialize state.\n   * @override\n   * @protected\n   */\n  _initState() {\n    this.state = {\n      val: this.o.minVal\n    };\n\n    // keep track of dimensions\n    this.dims = {\n      offsetBottom: 5,\n      offsetTop: 5,\n      bodyWidth: 2,\n      handleWidth: 10,\n      handleHeight: 10\n    };\n  }\n\n  /**\n   * Initialize the svg elements\n   * @override\n   * @protected\n   */\n  _initSvgEls() {\n    const _this = this;\n\n    this.svgEls = {\n      body: document.createElementNS(_this.SVG_NS, \"rect\"),\n      overlay: document.createElementNS(_this.SVG_NS, \"rect\"),\n      handle: document.createElementNS(_this.SVG_NS, \"polygon\")\n    };\n\n    this._appendSvgEls();\n    this._update();\n  }\n\n  /**\n   * Initialize mouse and touch event handlers\n   * @override\n   * @protected\n   */\n  _initHandlers() {\n    const _this = this;\n\n    this.handlers = {\n\n      touchBody: function touchBody(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        let newVal = _this._calcTouchVal(ev.clientY);\n        _this.setState({ val: newVal });\n        \n        _this.handlers.touchHandle(ev);\n      },\n\n      touchHandle: function touchHandle(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n        \n        document.body.addEventListener(\"mousemove\", _this.handlers.moveHandle);\n        document.body.addEventListener(\"touchmove\", _this.handlers.moveHandle);\n        document.body.addEventListener(\"mouseup\", _this.handlers.releaseHandle); \n        document.body.addEventListener(\"touchend\", _this.handlers.releaseHandle); \n      },\n\n      moveHandle: function moveHandle(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        let newVal = _this._calcTouchVal(ev.clientY);\n        \n        _this.setState({ val: newVal });\n      },\n\n      releaseHandle: function releaseHandle(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        document.body.removeEventListener(\"touchmove\", _this.handlers.moveHandle); \n        document.body.removeEventListener(\"mousemove\", _this.handlers.moveHandle);\n        document.body.removeEventListener(\"mouseup\", _this.handlers.releaseHandle); \n        document.body.removeEventListener(\"touchend\", _this.handlers.releaseHandle); \n      }\n    };\n\n    this.svgEls.overlay.addEventListener(\"mousedown\", _this.handlers.touchBody);\n    this.svgEls.overlay.addEventListener(\"touchstart\", _this.handlers.touchBody);\n    this.svgEls.handle.addEventListener(\"mousedown\", _this.handlers.touchHandle);\n    this.svgEls.handle.addEventListener(\"touchstart\", _this.handlers.touchHandle);\n  }\n\n  /**\n   * Update (redraw) component based on state\n   * @override\n   * @protected\n   */\n  _update() {\n    const _this = this;\n\n    let sliderBodyPos = _this._calcSliderBodyPos();\n\n    this.svgEls.body.setAttribute(\"x\", sliderBodyPos.x);\n    this.svgEls.body.setAttribute(\"y\", sliderBodyPos.y);\n    this.svgEls.body.setAttribute(\"width\", _this.dims.bodyWidth);\n    this.svgEls.body.setAttribute(\"height\", _this._calcSliderBodyHeight());\n    this.svgEls.body.setAttribute(\"fill\", _this.o.sliderBodyColor);\n\n    this.svgEls.overlay.setAttribute(\"x\", sliderBodyPos.x);\n    this.svgEls.overlay.setAttribute(\"y\", sliderBodyPos.y);\n    this.svgEls.overlay.setAttribute(\"width\", _this.dims.bodyWidth + _this.dims.handleWidth);\n    this.svgEls.overlay.setAttribute(\"height\", _this._calcSliderBodyHeight());\n    this.svgEls.overlay.setAttribute(\"fill\", \"transparent\");\n\n    let sliderHandlePoints = _this._calcSliderHandlePoints();\n\n    this.svgEls.handle.setAttribute(\"points\", sliderHandlePoints);\n    this.svgEls.handle.setAttribute(\"fill\", _this.o.sliderHandleColor);\n  }\n\n  /* ===========================================================================\n  *  PUBLIC API\n  */\n\n  /**\n   * Get the slider value.\n   * @public\n   */\n  getVal() {\n    return this.state.val;\n  }\n\n  /**\n   * Set the current slider value.\n   * Same as setVal(), but will not cause an observer callback trigger.\n   * @public\n   * @param {number} newVal - The new slider value.\n   */\n  setInternalVal(newVal) {\n    this.setInternalState({ val: newVal });\n  }\n\n  /**\n   * Set the current slider value.\n   * Same as setInternalVal(), but will cause an observer callback trigger.\n   * @public\n   * @param {number} newVal - The new slider value.\n   */\n  setVal(newVal) {\n    this.setState({ val: newVal });\n  }\n\n  /* ===========================================================================\n  *  HELPER METHODS\n  */\n\n  /**\n   * Returns the position and dimensions for the slider body.\n   * @private\n   * @returns {object} - {x, y} position.\n   */\n  _calcSliderBodyPos() {\n    const _this = this;\n\n    return {\n      x: _this._getWidth() / 2 - 1,\n      y: _this.dims.offsetTop\n    };\n  }\n\n  /**\n   * Returns the height of the slider body.\n   * @private\n   * @returns {number} - Height of the slider body.\n   */\n  _calcSliderBodyHeight() {\n    return this._getHeight() - this.dims.offsetTop - this.dims.offsetBottom;\n  }\n\n  /**\n   * Returns the height of the slider body.\n   * @private\n   * @returns {number} - Width of the slider body.\n   */\n  _calcSliderBodyWidth() {\n    return this.dims.bodyWidth;\n  }\n\n    /**\n   * Returns the position and dimensions for the slider body.\n   * @private\n   * @returns {object} - {x, y} position.\n   */\n  _calcSliderHandlePoints() {\n    const _this = this;\n\n    let sliderBodyHeight = _this._calcSliderBodyHeight();\n\n    let x0 = (_this._getWidth() / 2) + 1;\n    let y0 = (sliderBodyHeight - (_this.state.val / (_this.o.maxVal - _this.o.minVal)) * sliderBodyHeight) + _this.dims.offsetBottom;\n    let x1 = x0 + this.dims.handleWidth;\n    let y1 = y0 - this.dims.handleHeight / 2;\n    let x2 = x1;\n    let y2 = y0 + this.dims.handleHeight / 2;\n\n    return x0 + \",\" + y0 + \" \" +\n           x1 + \",\" + y1 + \" \" +\n           x2 + \",\" + y2;\n  }\n\n  /**\n   * Calculate the value of the slider touched at position y.\n   * @private\n   * @param {number} y - Y-value of the touch location.\n   * @returns {number} - Value of the slider at the touched location.\n   */\n  _calcTouchVal(y) {\n    let valRange = this.o.maxVal - this.o.minVal;\n    let bodyY = (this._getHeight() - this._getRelativeY(y)) - this.dims.offsetBottom;\n    let touchVal = ((bodyY / this._calcSliderBodyHeight()) * valRange) + this.o.minVal; \n\n    return touchVal;\n  }\n\n  /**\n   * Calculates the precision with which the state value changes when moved.\n   */\n  _calcMovePrecision() {\n    let precision = (this.o.maxVal - this.o.minVal) / 127;\n    return precision;\n  }\n}\n\nexport default Slider;\n\n\n// WEBPACK FOOTER //\n// ./src/ui/slider.js","import Widget from \"ui/core/widget\";\nimport Constraint from \"util/constraint\";\nimport ConstraintSpec from \"util/constraint-def\";\nimport MathUtil from \"util/util-math\";\n\n/**\n * Class representing a Graph widget.\n * @class \n * @implements {Widget}\n */\nclass Graph extends Widget {\n\n  /**\n   * @constructor\n   * @param {object} container - DOM container for the widget.\n   * @param {object} [o] - Options.\n   * @param {number} [o.minXVal=0] - Minimum X value.\n   * @param {number} [o.minYVal=0] - Minimum Y value.\n   * @param {number} [o.maxXVal=100] - Maximum X value.\n   * @param {number} [o.maxYVal=100] - Maximum Y value.\n   * @param {number} [o.maxNumVertices=-1] - Maximum number of vertices.\n   * @param {number} [o.quantizeX=0.1] - X-quantization (\"grid\") value.\n   * @param {number} [o.quantizeY=0.1] - Y-quantization (\"grid\") value.\n   * @param {number} [o.xDecimalPrecision=1] - Number of decimal places for output of the X values.\n   * @param {number} [o.yDecimalPrecision=1] - Number of decimal places for output of the Y values.\n   * @param {boolean} [o.isEditable=true] - Is the graph editable?\n   * @param {string} [o.vertexColor=\"#f40\"] - Color of vertex points.\n   * @param {string} [o.lineColor=\"#484848\"] - Color of lines connecting the vertices.\n   * @param {string} [o.backgroundColor=\"#fff\"] - Background color.\n   * @param {number} [o.lineWidth=2] - Width of the connecting lines.\n   * @param {number} [o.vertexRadius=4] - Radius of the vertex points.\n   * @param {number} [o.mouseSensitivity=1.2] - Mouse sensitivity (how much moving the mouse affects the interaction).\n   */\n  constructor(container, o) {\n    super(container, o);\n  }\n\n  /* ===========================================================================\n  *  PUBLIC API\n  */\n\n  /**\n   * Sets the options.\n   * @public @override\n   */\n  setOptions(o) {\n    o = o || {};\n\n    super.setOptions(o);\n  }\n\n  /**\n  * Returns the state as an array of [x, y] pairs.\n  * @public @override\n  */\n  getVal() {\n    return this.state.vertices.map(vtx => [vtx.x, vtx.y]);\n  }\n\n  /**\n  * Sets the state as an array of [x, y] vertex pairs.\n  * Same as setVal(), but will not trigger observer callback methods.\n  * @public @override\n  * @param {array} - An array of [x, y] points\n  */\n  setInternalVal(vertexArray) {\n   let vertices = vertexArray.map(xyPair => { return {x: xyPair[0], y: xyPair[1]}; });\n\n   this.setInternalState({ vertices: vertices });\n  }\n\n  /**\n  * Sets the state as an array of [x, y] vertex pairs.\n  * Same as setInternalVal(), but will trigger observer callback methods.\n  * @public @override\n  * @param {array} - An array of [x, y] points.\n  */\n  setVal(vertexArray) {\n    let vertices = vertexArray.map(xyPair => { return {x: xyPair[0], y: xyPair[1]}; });\n\n    this.setState({ vertices: vertices });\n  }\n\n  /**\n   * Sets the value of a particular vertex, selected by its index. \n   * Note: will not trigger observer notifications.\n   * @public\n   * @param {number} val - Value to set.\n   * @param {number} idx - Index of the vertex to set the value for.\n   * @returns {number} - Index of the vertex that has been set, or -1 if no such vertex exists.\n   */\n  setVertexVal(val, idx) {\n    if (idx >= 0 && idx < this.state.vertices.length) {\n      let vertices = this.state.vertices.map(vtx => vtx);\n      vertices[idx].y = val;\n      this.setInternalState({ vertices: vertices });\n      return idx;\n    } else {\n      return -1;\n    }\n  }\n\n  /**\n   * Returns the number of vertices set on this graph.\n   * @public\n   * @return {number} - Number of vertices.\n   */\n  getNumVertices() {\n    return this.state.vertices.length;\n  }\n\n  /**\n   * Adds new vertices to the state.\n   * Each vertex is represented as x and y values, as well as optional boolean flags\n   * specifying whether the x, y, or both values should be fixed (unchangeble).\n   * The x and y values may also take the strings \"min\", \"max\" to specify that the coordinates \n   * should be tied to the minimum or maximum possible x or y values for the graph.\n   * @public\n   * @param {...object} vtx - Object representing the new vertex to add.\n   * @param {number} [vtx.x=minXVal] - X coordinate for the new vertex.\n   * @param {number} [vtx.y=minYVal] - Y coordinate for the new vertex.\n   * @param {boolean} [vtx.isXFixed=false] - Is the X coordinate fixed (unable to move)?\n   * @param {boolean} [vtx.isYFixed=false] - Is the Y coordinate fixed (unable to move)?\n   */\n  addVertex(...vtx) {\n    for (let i = 0; i < vtx.length; i++) {\n      let newVtx = vtx[i];\n\n      newVtx = (typeof newVtx !== 'undefined') ? newVtx : {};\n      newVtx.x = (typeof newVtx.x !== 'undefined') ? newVtx.x : this.o.minXVal;\n      newVtx.y = (typeof newVtx.y !== 'undefined') ? newVtx.y : this.o.minYVal;\n      newVtx.isXFixed = (typeof newVtx.isXFixed !== 'undefined') ? newVtx.isXFixed : false;\n      newVtx.isYFixed = (typeof newVtx.isYFixed !== 'undefined') ? newVtx.isYFixed : false;\n      newVtx.xAnchor = \"\";\n      newVtx.yAnchor = \"\";\n\n      if (newVtx.x === \"max\") {\n        newVtx.isXFixed = true;\n        newVtx.x = this.o.maxXVal;\n        newVtx.xAnchor = \"max\";\n      } else if (newVtx.x === \"min\") {\n        newVtx.isXFixed = true;\n        newVtx.x = this.o.minXVal;\n        newVtx.xAnchor = \"min\";\n      }\n\n      if (newVtx.y === \"max\") {\n        newVtx.isYFixed = true;\n        newVtx.y = this.o.maxYVal;\n        newVtx.yAnchor = \"max\";\n      } else if (newVtx.x === \"min\") {\n        newVtx.isYFixed = true;\n        newVtx.y = this.o.minYVal;\n        newVtx.yAnchor = \"min\";\n      }\n\n      let newVertices = this.getState().vertices.map(x=>x);\n\n      newVertices.push(newVtx);\n      newVertices.sort((a, b) => a.x - b.x);\n\n      this.setState({\n        vertices: newVertices\n      });\n    }\n  }\n\n  /**\n   * Adds a vertex with fixed x and y coordinates.\n   * @param {object} vtx - Vertex coordinates in format {x, y}\n   * @param {number} vtx.x - X coordinate of the vertex.\n   * @param {number} vtx.y - Y coordinate of the vertex.\n   */\n  addFixedVertex(...vtx) {\n    for (let i = 0; i < vtx.length; i++) {\n      let newVtx = vtx[i];\n      this.addVertex({ x: newVtx.x, y: newVtx.y, isXFixed: true, isYFixed: true });\n    }\n  }\n\n  /**\n   * Adds a vertex with fixed y coordinate.\n   * @param {object} vtx - Vertex coordinates in format {x, y}\n   * @param {number} vtx.x - X coordinate of the vertex.\n   * @param {number} vtx.y - Y coordinate of the vertex.\n   */\n  addFixedXVertex(...vtx) {\n    for (let i = 0; i < vtx.length; i++) {\n      let newVtx = vtx[i];\n      this.addVertex({ x: newVtx.x, y: newVtx.y, isXFixed: true, isYFixed: false });\n    }\n  }\n\n\n  /**\n   * Adds a vertex with fixed y coordinate.\n   * @param {object} vtx - Vertex coordinates in format {x, y}\n   * @param {number} vtx.x - X coordinate of the vertex.\n   * @param {number} vtx.y - Y coordinate of the vertex.\n   */\n  addFixedYVertex(...vtx) {\n    for (let i = 0; i < vtx.length; i++) {\n      let newVtx = vtx[i];\n      this.addVertex({ x: newVtx.x, y: newVtx.y, isXFixed: false, isYFixed: true });\n    }\n  }\n\n  /* ============================================================================================= */\n  /* INITIALIZATION METHODS\n  /* ============================================================================================= */\n\n  /**\n   * Initializes the options.\n   * @override\n   * @private\n   */\n  _initOptions(o) {\n    // set defaults\n    this.o = {};\n\n    this.o.minXVal = 0;\n    this.o.minYVal = 0;\n    this.o.maxXVal = 100;\n    this.o.maxYVal = 100;\n    this.o.maxNumVertices = -1;\n    this.o.quantizeX = 0.1;\n    this.o.quantizeY = 0.1;\n    this.o.xDecimalPrecision = 1;\n    this.o.yDecimalPrecision = 1;\n    this.o.isEditable = true;\n    this.o.vertexColor = \"#f40\";\n    this.o.fixedVertexColor = this.o.vertexColor;\n    this.o.lineColor = \"#484848\";\n    this.o.backgroundColor = \"#fff\";\n    this.o.vertexRadius = 4;\n    this.o.lineWidth = 2;\n    this.o.mouseSensitivity = 1.2;\n\n    // override defaults with provided options\n    super._initOptions(o);\n  }\n\n  /**\n   * Initializes state constraints.\n   * @override\n   * @private\n   */\n  _initStateConstraints() {\n    const _this = this;\n\n    this.stateConstraints = new ConstraintSpec({\n      vertices: [{\n        x: new Constraint({\n          min: _this.o.minXVal,\n          max: _this.o.maxXVal,\n          transform: (num) => {\n            return MathUtil.quantize(num, _this.o.quantizeX);\n          }\n        }),\n        y: new Constraint({\n          min: _this.o.minYVal,\n          max: _this.o.maxYVal,\n          transform: (num) => {\n            return MathUtil.quantize(num, _this.o.quantizeY);\n          }\n        })\n      }]\n    });\n  }\n\n  /**\n   * Initializes state.\n   * @override\n   * @private\n   */\n  _initState() {\n    this.state = {\n      // verices contains an array of vertices\n      // each vertex is an object of form \n      // {\n      //   x: numbber, \n      //   y: number, \n      //   isXFixed: boolean, \n      //   isYFixed: boolean,\n      //   xAnchor: string,\n      //   yAnchor: string\n      // }\n      // isXFixed and isYFixed are boolean values that tell if a given\n      // vertex may be moved in the x and y planes\n      vertices: []\n    };\n  }\n\n  /**\n   * Initializes the svg elements.\n   * @override\n   * @private\n   */\n  _initSvgEls() {\n    const _this = this;\n\n    this.svgEls = {\n      panel: document.createElementNS(this.SVG_NS, \"rect\"),\n      vertices: [],\n      lines: []\n    };\n\n    this.svgEls.panel.setAttribute(\"width\", this._getWidth());\n    this.svgEls.panel.setAttribute(\"height\", this._getHeight());\n    this.svgEls.panel.setAttribute(\"fill\", this.o.backgroundColor);\n    this.svgEls.panel.setAttribute(\"stroke\", this.o.lineColor);\n\n    this._appendSvgEls();\n    this._update();\n  }\n\n  /**\n   * Initializes mouse and touch event handlers.\n   * @override\n   * @private\n   */\n  _initHandlers() {\n    const _this = this;\n\n    let targetVtx = null;\n    let targetLine = null;\n    let vtxPos0 = {}; // original poisition of two vertices affected by a line move\n    let x0 = 0;\n    let y0 = 0;\n    let x1 = 0;\n    let y1 = 0;\n    let dx = 0;\n    let dy = 0;\n\n    this.handlers = {\n\n       touchPanel: function touchPanel(ev) {\n         ev.preventDefault();\n\n         let xPos = ev.clientX - _this._getLeft();\n         let yPos = ev.clientY - _this._getTop();\n         let vertexState = _this._calcVertexState({x: xPos, y: yPos});\n\n         _this.addVertex(vertexState);\n       },\n\n       touchVertex: function touchVertex(ev) {\n         ev.preventDefault();\n\n         targetVtx = ev.target;\n\n         document.addEventListener(\"mousemove\", _this.handlers.moveVertex);\n         document.addEventListener(\"touchmove\", _this.handlers.moveVertex);\n         ev.target.addEventListener(\"mouseup\", _this.handlers.deleteVertex);\n         ev.target.addEventListener(\"touchend\", _this.handlers.deleteVertex);\n       },\n\n       touchLine: function touchLine(ev) {\n         ev.preventDefault();\n\n         targetLine = ev.target;\n\n         x0 = ev.clientX - _this._getLeft();\n         y0 = ev.clientY - _this._getTop();\n         vtxPos0 = null;\n\n         document.addEventListener(\"mousemove\", _this.handlers.moveLine);\n         document.addEventListener(\"touchmove\", _this.handlers.moveLine);\n       },\n\n       moveLine: function moveLine(ev) {\n         ev.preventDefault();\n\n         document.addEventListener(\"mouseup\", _this.handlers.endMoveLine);\n         document.addEventListener(\"touchend\", _this.handlers.endMoveLine);\n\n         x1 = ev.clientX - _this._getLeft();\n         y1 = ev.clientY - _this._getTop();\n\n         // delta position (change in position)\n         let dPos = {\n           x: x1 - x0,\n           y: y1 - y0\n         };\n\n         vtxPos0 = _this._moveLine(targetLine, dPos, vtxPos0);\n       },\n\n       endMoveLine: function endMoveLine(ev) {\n         ev.preventDefault();\n\n         vtxPos0 = null;\n\n         document.removeEventListener(\"mousemove\", _this.handlers.moveLine);\n         document.removeEventListener(\"touchmove\", _this.handlers.moveLine);\n       },\n\n       deleteVertex: function deleteVertex(ev) {\n         ev.preventDefault();\n\n         document.removeEventListener(\"mousemove\", _this.handlers.moveVertex);\n         document.removeEventListener(\"touchmove\", _this.handlers.moveVertex);\n\n         _this._deleteVertex(ev.target);\n\n         ev.target.removeEventListener(\"mouseup\", _this.handlers.deleteVertex);\n         ev.target.removeEventListener(\"touchend\", _this.handlers.deleteVertex);\n       },\n\n       moveVertex: function moveVertex(ev) {\n         ev.preventDefault();\n\n         targetVtx.removeEventListener(\"mouseup\", _this.handlers.deleteVertex);\n         targetVtx.removeEventListener(\"touchend\", _this.handlers.deleteVertex);\n\n         document.addEventListener(\"mouseup\", _this.handlers.endMoveVertex);\n         document.addEventListener(\"touchend\", _this.handlers.endMoveVertex);\n\n         let xPos = ev.clientX - _this._getLeft();\n         let yPos = ev.clientY - _this._getTop();\n\n         _this._moveVertex(targetVtx, {x: xPos, y: yPos});\n       },\n\n       endMoveVertex: function endMoveVertex(ev) {\n         ev.preventDefault();\n\n         document.removeEventListener(\"mousemove\", _this.handlers.moveVertex);\n         document.removeEventListener(\"touchmove\", _this.handlers.moveVertex);\n       }\n    };\n\n    this.svgEls.panel.addEventListener(\"mousedown\", _this.handlers.touchPanel);\n    this.svgEls.panel.addEventListener(\"touchdown\", _this.handlers.touchPanel);\n\n    this.svgEls.vertices.forEach(vtx => {\n      vtx.addEventListener(\"mousedown\", _this.handlers.touchVertex);\n      vtx.addEventListener(\"touchdown\", _this.handlers.touchVertex);\n    });\n\n    this.svgEls.lines.forEach(line => {\n      line.addEventListener(\"mousedown\", _this.handlers.touchLine);\n      line.addEventListener(\"touchdown\", _this.handlers.touchLine);\n    });\n  }\n\n  /**\n   * Updates (redraws) component based on state.\n   * @override\n   * @private\n   */\n  _update() {\n    const _this = this;\n\n    // update vertices to have min and max values if specified\n    _this.state.vertices.forEach(vtx => {\n      vtx.x = (vtx.xAnchor === \"max\") ? _this.o.maxXVal :\n                (vtx.xAnchor === \"min\") ? _this.o.minXVal :\n                vtx.x;\n\n      vtx.y = (vtx.yAnchor === \"max\") ? _this.o.maxYVal :\n                (vtx.yAnchor === \"min\") ? _this.o.minYVal :\n                vtx.y;\n    });\n\n    // sort svg vertexes using a sort map\n    let idxSortMap = _this.state.vertices.map((vtx, idx) => { return { vtx: vtx, idx: idx }; });\n    idxSortMap.sort((a, b) => a.vtx.x - b.vtx.x);\n    _this.state.vertices = idxSortMap.map(el => _this.state.vertices[el.idx]);\n\n    // if there are more state vertices than svg vertices, add a corresponding number of svg vertices and lines\n    for (let i = _this.svgEls.vertices.length; i < _this.state.vertices.length; ++i) {\n      _this._addSvgVertex();\n    }\n\n    // if there are more svg vertices than state vertices, remove a corresponding number of svg vertices and lines\n    for (let i = _this.svgEls.vertices.length; i > _this.state.vertices.length; --i) {\n      _this._removeSvgVertex();\n    }\n\n    // sort the svg vertices according to the vertex sort map\n    _this.svgEls.vertices = idxSortMap.map(el => _this.svgEls.vertices[el.idx]);\n\n    // set the correct position coordinates for every vertex\n    _this.state.vertices.forEach((stateVtx, idx) => {\n      let svgVtx = _this.svgEls.vertices[idx];\n      let pos = _this._calcVertexPos(stateVtx);\n\n      svgVtx.setAttribute(\"cx\", pos.x);\n      svgVtx.setAttribute(\"cy\", pos.y);\n      svgVtx.setAttribute(\"r\", _this.o.vertexRadius);\n\n      let vtxFill = (_this.state.vertices[idx].isXFixed || _this.state.vertices[idx].isYFixed) ?\n                    _this.o.fixedVertexColor :\n                    _this.o.vertexColor;\n\n      svgVtx.setAttribute(\"fill\", vtxFill);\n\n      // for every vertex other than the first, draw a line to the previous vertex\n      if (idx > 0) {\n        let prevVtx = _this.state.vertices[idx - 1];\n        let prevPos = _this._calcVertexPos(prevVtx);\n        let line = _this.svgEls.lines[idx - 1];\n\n        line.setAttribute(\"d\", \"M \" + pos.x + \" \" + pos.y + \" L \" + prevPos.x + \" \" + prevPos.y);\n        line.setAttribute(\"fill\", \"transparent\");\n        line.setAttribute(\"stroke-width\", _this.o.lineWidth);\n        line.setAttribute(\"stroke\", _this.o.lineColor);\n      }\n    });\n\n    // remove and reappend all svg elements so that vertices are on top of lines\n    _this.svgEls.lines.forEach(svgLine => {\n      _this.svg.removeChild(svgLine);\n      _this.svg.appendChild(svgLine);\n    });\n\n    _this.svgEls.vertices.forEach(svgVtx => {\n      _this.svg.removeChild(svgVtx);\n      _this.svg.appendChild(svgVtx);\n    });\n\n    // reassign listeners\n    _this.svgEls.vertices.forEach(vtx => {\n      vtx.addEventListener(\"mousedown\", _this.handlers.touchVertex);\n      vtx.addEventListener(\"touchdown\", _this.handlers.touchVertex);\n    });\n\n    _this.svgEls.lines.forEach(line => {\n      line.addEventListener(\"mousedown\", _this.handlers.touchLine);\n      line.addEventListener(\"touchdown\", _this.handlers.touchLine);\n    });\n  }\n\n  /* ==============================================================================================\n  *  INTERNAL FUNCTIONALITY METHODS\n  */\n\n  /**\n   * Deletes a vertex.\n   * @private\n   * @param {SVGElement} targetVtx - Vertex to Delete\n   */\n  _deleteVertex(targetVtx) {\n    const _this = this;\n\n    let vtxIdx = this.svgEls.vertices.findIndex(vtx => vtx === targetVtx);\n    let isRemovable = !(this.state.vertices[vtxIdx].isXFixed || this.state.vertices[vtxIdx].isYFixed)\n\n    if (vtxIdx !== -1 && isRemovable) {\n      let newVertices = this.getState().vertices.map(x=>x);\n\n      newVertices.splice(vtxIdx, 1);\n      _this.setState({\n        vertices: newVertices\n      });\n    }\n  }\n\n  /**\n   * Adds a new SVG vertex representation.\n   * @private\n   */\n  _addSvgVertex() {\n    const _this = this;\n\n    let newVertex = document.createElementNS(_this.SVG_NS, \"circle\");\n    _this.svgEls.vertices.push(newVertex);\n    _this.svg.appendChild(newVertex);\n\n    // if there is more than 1 svg vertex, we also need to draw lines between them\n    if (_this.svgEls.vertices.length > 1) {\n      this._addSvgLine();\n    }\n  }\n\n  /**\n   * Adds an SVG line connecting two vertices.\n   * @private\n   */\n  _addSvgLine() {\n    let newLine = document.createElementNS(this.SVG_NS, \"path\");\n    this.svg.appendChild(newLine);\n    this.svgEls.lines.push(newLine);\n  }\n\n  /**\n   * Removes an SVG vertex.\n   * @private\n   */\n  _removeSvgVertex() {\n    let vertex = this.svgEls.vertices[this.svgEls.vertices.length - 1];\n\n    this.svg.removeChild(vertex);\n    vertex = null;\n    this.svgEls.vertices.pop();\n\n    if (this.svgEls.lines.length > 0) {\n     this._removeSvgLine();\n    }\n  }\n\n  /**\n   * Removes an SVG line connecting two vertices.\n   * @private\n   */\n  _removeSvgLine() {\n    let line = this.svgEls.lines[this.svgEls.lines.length - 1];\n\n    this.svg.removeChild(line);\n    line = null;\n    this.svgEls.lines.pop();\n  }\n\n  /**\n    * Moves a line.\n    * @private\n    * @param {SVGElement} targetLine - The target line\n    * @param {object} dPos -\n    * @param {number} dPos.x\n    * @param {number} dPos.y\n    * @param {object} vtxPos0 - Original position (before moving)\n    *                           of the two vertices immediately to the left\n    *                           and right of the line being moved in the\n    *                           form { vtx1: {x, y}, vtx2: {x, y}, boundaryBL: {x, y}, boundaryTR: {x, y} }\n    *                           If null, will be calculated from the\n    *                           corresponding svg element.\n    * @param {obect} [vtxPos0.vtx1]\n    * @param {number} [vtxPos0.vtx1.x]\n    * @param {number} [vtxPos0.vtx1.y]\n    * @param {obect} [vtxPos0.vtx2]\n    * @param {number} [vtxPos0.vtx2.x]\n    * @param {number} [vtxPos0.vtx2.y]\n    * @returns {object} Original position of the two vertices affected by the line move in the form\n    *                   { vtx1: {x, y}, vtx2: {x, y}, boundaryBL: {x, y}, boundaryTR: {x, y} }.\n    */\n  _moveLine(targetLine, dPos, vtxPos0) {\n    const _this = this;\n\n    let lineIdx = _this.svgEls.lines.findIndex(line => line === targetLine);\n\n    // get vertices to the left and right of the selected line\n    let vtx1 = _this.svgEls.vertices[lineIdx];\n    let vtx2 = _this.svgEls.vertices[lineIdx + 1];\n\n    let vtx1curPos = {\n      x: parseInt(_this.svgEls.vertices[lineIdx].getAttribute(\"cx\")),\n      y: parseInt(_this.svgEls.vertices[lineIdx].getAttribute(\"cy\"))\n    };\n    let vtx2curPos = {\n      x: parseInt(_this.svgEls.vertices[lineIdx + 1].getAttribute(\"cx\")),\n      y: parseInt(_this.svgEls.vertices[lineIdx + 1].getAttribute(\"cy\"))\n    };\n\n    // if vtxPos0 is null or undefined, this is the first time this function\n    // was called in the line move, and we need to get the position of affected\n    // vertices from the svg attributes.\n    // vtx1 and vtx2 are the left and right vertices bounding the line\n    // boundaryBL is the bottom left boundary restricting movement of the line\n    // boundaryTR is the top right boundary restricting movement of the line\n    if (vtxPos0 === null || vtxPos0 === undefined) {\n\n      let boundaryBL = {\n        x: (lineIdx > 0) ? \n               parseInt(_this.svgEls.vertices[lineIdx - 1].getAttribute(\"cx\"))\n            : _this._calcVertexPos({x: _this.o.minXVal, y: _this.o.minYVal}).x,\n        y: _this._calcVertexPos({x: _this.o.minXVal, y: _this.o.minYVal}).y\n      };\n\n      let boundaryTR = {\n        x: (lineIdx + 2 < _this.svgEls.vertices.length) ? \n              parseInt(_this.svgEls.vertices[lineIdx + 2].getAttribute(\"cx\"))\n            : _this._calcVertexPos({x: _this.o.maxXVal, y: _this.o.maxYVal}).x,\n        y: _this._calcVertexPos({x: _this.o.maxXVal, y: _this.o.maxYVal}).y\n      };\n\n      vtxPos0 = {\n       vtx1: vtx1curPos,\n       vtx2: vtx2curPos,\n       boundaryBL: boundaryBL,\n       boundaryTR: boundaryTR\n      };\n    }\n\n    // calculate the new positions for the two affected vertices\n    let vtx1newPos = {\n      x: vtxPos0.vtx1.x + dPos.x,\n      y: vtxPos0.vtx1.y + dPos.y\n    };\n\n    let vtx2newPos = {\n      x: vtxPos0.vtx2.x + dPos.x,\n      y: vtxPos0.vtx2.y + dPos.y\n    };\n\n    // if moving would take x values outside of boundaries, keep x values the same\n    if (vtx1newPos.x < vtxPos0.boundaryBL.x || \n        vtx2newPos.x < vtxPos0.boundaryBL.x || \n        vtx1newPos.x > vtxPos0.boundaryTR.x || \n        vtx2newPos.x > vtxPos0.boundaryTR.x) {\n      vtx1newPos.x = vtx1curPos.x;\n      vtx2newPos.x = vtx2curPos.x;\n    }\n\n    // if moving would take y values outside of boundaries, keep y values the same\n    // remember that y-coordinates are inverted when dealing with the canvas\n    if (vtx1newPos.y > vtxPos0.boundaryBL.y || \n        vtx2newPos.y > vtxPos0.boundaryBL.y || \n        vtx1newPos.y < vtxPos0.boundaryTR.y || \n        vtx2newPos.y < vtxPos0.boundaryTR.y) {\n      vtx1newPos.y = vtx1curPos.y;\n      vtx2newPos.y = vtx2curPos.y;\n    }\n\n    this._moveVertex(vtx1, vtx1newPos);\n    this._moveVertex(vtx2, vtx2newPos);\n\n    // return the original position so that it may be used again if the line move is not finished\n    return vtxPos0;\n  }\n\n  /**\n  * Moves a vertex.\n  * @private\n  * @param {SVGElement} targetVtx - The target vertex\n  * @param {Object} newPos - The new position\n  * @param {number} newPos.x\n  * @param {number} newPos.y\n  */\n  _moveVertex(targetVtx, newPos) {\n    const _this = this;\n\n    let vtxState = _this._calcVertexState(newPos);\n    let vtxIdx = _this.svgEls.vertices.findIndex(vtx => vtx === targetVtx);\n\n    let vertices = _this.getState().vertices.map(x=>x);\n\n    // move the vertex if it's not fixed in x or y direction\n    vertices[vtxIdx].x = (vertices[vtxIdx].isXFixed) ? vertices[vtxIdx].x : vtxState.x;\n    vertices[vtxIdx].y = (vertices[vtxIdx].isYFixed) ? vertices[vtxIdx].y : vtxState.y;\n\n    _this.setState({\n      vertices: vertices\n    });\n  }\n\n  /* ===========================================================================\n  *  HELPER METHODS\n  */\n\n  /**\n   * Calculates the x and y for a vertex in the graph according to its state value.\n   * @private\n   */\n  _calcVertexPos(vertexState) {\n    return {\n     x: this._getWidth() * (vertexState.x / this.o.maxXVal),\n     y: this._getHeight() - (this._getHeight() * (vertexState.y / this.o.maxYVal))\n    };\n  }\n\n  /**\n   * Calculates the x and y for a vertex state based on position on the graph.\n   * (inverse of _calcVertexPos).\n   * @private\n   */\n  _calcVertexState(vertexPos) {\n    return {\n      x: this.o.maxXVal * (vertexPos.x / this._getWidth()),\n      y: this.o.maxYVal - (this.o.maxYVal * (vertexPos.y / this._getHeight()))\n    };\n  }\n\n  /**\n   * Converts on-screen x distance to scaled x state-value.\n   * @private\n   */\n  _xPxToVal(x) {\n    return (x / this._getWidth()) * (this.o.maxXVal - this.o.minXVal);\n  }\n\n  /**\n   * Converts on-screen y distance to scaled y state-value.\n   * @private\n   */\n  _yPxToVal(y) {\n    return (y / this._getHeight()) * (this.o.maxYVal - this.o.minYVal);\n  }\n}\n\nexport default Graph;\n\n\n// WEBPACK FOOTER //\n// ./src/ui/graph.js","import Widget from \"ui/core/widget\";\nimport Constraint from \"util/constraint\";\nimport ConstraintSpec from \"util/constraint-def\";\n\n/**\n * Class representing an Numberbox widget.\n * @class\n * @implements {Widget}\n */\nclass Numberbox extends Widget {\n\n  /**\n   * @constructor\n   * @param {object} container - DOM container for the widget.\n   * @param {object} [o] - Options.\n   * @param {number} [o.minVal=null] - Minimum value. \n   * @param {number} [o.maxVal=null] - Maximum value.\n   * @param {number} [o.precision=0] - Number of decimal places to use.\n   * @param {string} [o.backgroundColor=\"#282828\"] - The background color.\n   * @param {string} [o.fontColor=\"#aaa\"] - The font color.\n   * @param {string} [o.fontSize=\"12px\"] - The font size.\n   * @param {string} [o.fontFamily=\"Arial\"] - The font family.\n   * @param {string} [o.appendString=\"\"] - String to append to the value when displaying (i.e. \" Hz\").\n   */\n  constructor(container, o) {\n    super(container, o);\n  }\n\n  /* ==============================================================================================\n  *  PUBLIC API\n  */\n\n  /**\n   * Returns the current value.\n   * @public @override\n   * @returns {number} - Current value.\n   */\n  getVal() {\n    return this.state.val;\n  }\n\n  /**\n   * Sets the current value.\n   * Same as setVal(), but will not cause an observer callback trigger.\n   * @public @override\n   * @param {number} newVal - The new value.\n   */\n  setInternalVal(newVal) {\n    this.setInternalState({ val: newVal });\n  }\n\n  /**\n   * Sets the current value.\n   * Same as setInternalVal(), but will cause an observer callback trigger.\n   * @public @override\n   * @param {number} newVal - The new value.\n   */\n  setVal(newVal) {\n    this.setState({ val: newVal });\n  }\n\n  /* ==============================================================================================\n  *  INITIALIZATION METHODS\n  */\n\n  /**\n   * Initializes the options.\n   * @private @override\n   */\n  _initOptions(o) {\n    // set the defaults\n    this.o = {\n      minVal: 0,\n      maxVal: 127,\n      precision: 0,\n      quantizeInterval: 1, \n      backgroundColor: \"#282828\",\n      fontColor: \"#ccc\",\n      fontSize: \"12px\",\n      fontFamily: \"Arial\",\n      appendString: \"\",\n      mouseSensitivity: 1.2\n    };\n\n    // override defaults with provided options\n    super._initOptions(o);\n  }\n\n  /**\n   * Initializes state constraints.\n   * @private @override\n   */\n  _initStateConstraints() {\n    const _this = this;\n\n    let valConstraintDef = {\n      transform: (num) => {\n        console.log(\"val: \", _this.state.val, \"num: \", num); \n        return num.toFixed(0); \n      }\n    };\n\n    if (this.o.minVal !== null) {\n      valConstraintDef.minVal = this.o.minVal;\n    }\n\n    if (this.o.maxVal !== null) {\n      valConstraintDef.maxVal = this.o.maxVal;\n    }\n\n    this.stateConstraints = new ConstraintSpec({\n      val: new Constraint(valConstraintDef)\n    });\n  }\n\n  /**\n   * Initializes the state.\n   * @private @override\n   */\n  _initState() {\n    this.state = {\n      val: 0\n    };\n  }\n\n  /**\n   * Initializes the svg elements.\n   * @private @override\n   */\n  _initSvgEls() {\n    const _this = this;\n\n    this.svgEls = {\n      panel: document.createElementNS(_this.SVG_NS, \"rect\"),\n      text: document.createElementNS(_this.SVG_NS, \"text\"),\n      overlay: document.createElementNS(_this.SVG_NS, \"rect\"),\n    };\n\n    this.svgEls.text.setAttribute(\"alignment-baseline\", \"middle\");\n    this.svgEls.text.setAttribute(\"text-anchor\", \"middle\");\n\n    this._appendSvgEls();\n    this._update();\n  }\n\n  /**\n   * Initializes mouse and touch event handlers.\n   * @private @override\n   */\n  _initHandlers() {\n    const _this = this;\n    \n    let y0 = 0;\n    let yD = 0;\n    let newVal = _this.getState().val;\n\n    this.handlers = {\n\n      touch: function(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        y0 = ev.clientY;\n\n        document.addEventListener(\"mousemove\", _this.handlers.move);\n        document.addEventListener(\"touchmove\", _this.handlers.move);\n        document.addEventListener(\"mouseup\", _this.handlers.release);\n        document.addEventListener(\"touchend\", _this.handlers.release);\n      },\n\n      move: function(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        yD = y0 - ev.clientY;\n\n        newVal = _this.getVal() + (yD * _this.o.mouseSensitivity);\n\n        _this.setState({\n          val: newVal\n        });\n      },\n\n      release: function(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        document.removeEventListener(\"mousemove\", _this.handlers.move);\n        document.removeEventListener(\"touchmove\", _this.handlers.move);\n      }\n    };\n\n    this.svg.addEventListener(\"mousedown\", _this.handlers.touch);\n    this.svg.addEventListener(\"touchstart\", _this.handlers.touch);\n  }\n\n  /**\n   * Updates (redraws) components based on state.\n   * @private @override\n   */\n  _update() {\n    const _this = this;\n\n    this.svgEls.text.textContent = this.state.val + this.o.appendString;\n\n    let panelWidth = _this._getWidth();\n    let panelHeight = _this._getHeight();\n    let textWidth = this.svgEls.text.getBoundingClientRect().width;\n    let textHeight = this.svgEls.text.getBoundingClientRect().height;\n\n    this.svgEls.panel.setAttribute(\"fill\", _this.o.backgroundColor);\n    this.svgEls.panel.setAttribute(\"width\", panelWidth);\n    this.svgEls.panel.setAttribute(\"height\", panelHeight);\n\n    this.svgEls.text.setAttribute(\"x\", panelWidth / 2);\n    this.svgEls.text.setAttribute(\"y\", panelHeight / 2);\n    this.svgEls.text.setAttribute(\"fill\", _this.o.fontColor);\n\n    this.svgEls.overlay.setAttribute(\"fill\", \"transparent\");\n    this.svgEls.overlay.setAttribute(\"width\", _this._getWidth());\n    this.svgEls.overlay.setAttribute(\"height\", _this._getHeight());\n  }\n\n  /* ==============================================================================================\n  *  INTERNAL FUNCTIONALITY METHODS\n  */\n}\n\nexport default Numberbox;\n\n\n// WEBPACK FOOTER //\n// ./src/ui/numberbox.js","import Widget from \"ui/core/widget\";\nimport Constraint from \"util/constraint\";\nimport ConstraintSpec from \"util/constraint-def\";\n\n/**\n * Class representing an piano keyboard widget\n *\n * @class\n * @implements {Widget}\n */\nclass Keyboard extends Widget {\n\n  /**\n   * @constructor\n   * @param {object} container - DOM container for the widget.\n   * @param {object} [o] - Options.\n   * @param {number} [o.bottomNote=48] - The bottom note (MIDI pitch) of the keyboard.\n   * @param {number} [o.topNote=71] - The top note (MIDI pitch) of the keyboard.\n   * @param {string} [o.keyBorderColor=\"#484848\"] - The color of the border separating the keys.\n   * @param {string} [o.blackKeyColor=\"#484848\"] - The color used for the black keys.\n   * @param {string} [o.whiteKeyColor=\"#fff\"] - The color used for the white keys.\n   * @param {string} [o.blackKeyActiveColor=\"#888\"] - The color used to represent an active black key.\n   * @param {string} [o.whiteKeyActiveColor=\"#333\"] - The color used to represent an active white key.\n   * @param {number} [o.blackKeyHeightAspect=0.6] - The aspect ratio of black key height to white key height.\n   * @param {number} [o.blackKeyWidthAspect=0.66] - The aspect ratio of black key width to white key width.\n   * @param {string} [o.orientation=\"horizontal\"] - The keyboard orientation. sible values are 'monophonic'\n   *                                       (only one active note at a time), or 'polyphonic'\n   *                                       (can have several active notes at a time).\n   * @param {boolean} [o.isEditable=true] - Boolean specifying whether the keyboard\n   *                                      is editable by the mouse or touch interactions.\n   *                                      A non-editable keyboard may be used as a visual\n   *                                      diagram, for example.\n   */\n  constructor(container, o) {\n    super(container, o);\n  }\n\n  /* ==============================================================================================\n  *  PUBLIC API\n  */\n\n  /**\n   * Sets the options.\n   * @public\n   * @override\n   * @param {object} [o] - Options to set. See {@link Keyboard#constructor} for list of options. \n   */\n  setOptions(o) {\n    o = o || {};\n\n    // ensure that the bottom note is a white key (a black key cannot be at the edge when drawing the keyboard)\n    if (o.bottomNote !== undefined && !this._isWhiteKey(o.bottomNote)) {\n      --o.bottomNote;\n    }\n\n    // ensure that the bottom note is a white key (a black key cannot be at the edge when drawing the keyboard)\n    if (o.topNote !== undefined && !this._isWhiteKey(o.topNote)) {\n      ++o.topNote;\n    }\n\n    super.setOptions(o);\n  }\n\n  /**\n   * Returns the last note event.\n   * @public\n   * @override\n   * @returns {object} - An object representing the last note event that occured as {pitch, vel}\n   */\n  getVal() {\n    return Object.assign({}, this.lastNoteEvent);\n  }\n\n  /**\n   * Returns the currently active notes.\n   * @public\n   * @override\n   * @returns {array} - An array of active notes. Each element is a [pitch, vel] pair.\n   */\n  getActiveNotes() {\n    return this.getState().activeNotes.map(note => [ note.pitch, note.vel ]);\n  }\n\n  /**\n   * Sets the current keyboard state using an array of {pitch, val} objects.\n   * Same as setVal(), but will not cause an observer callback trigger.\n   * @public\n   * @override\n   * @param {array} newNote - New value (array representing active notes with each entry in the form {pitch, val}).\n   * @param {boolean} isVelToggled - A boolean indicating whether a non-zero vel of the same \n   *                                  pitch will turn a note off if it is turned on.\n   */\n  setInternalVal(newNote, isVelToggled) {\n    let newState = this._getNewStateFromNewNote(newNote, isVelToggled);\n    this.setInternalState(newState);\n  }\n\n  /**\n   * Sets the current keyboard state using an array of {pitch, val} objects.\n   * Same as setInternalVal(), but will cause an observer callback trigger.\n   * @public\n   * @param {array} newVal - New value (array representing active notes with each entry in the form {pitch, val}).\n   * @param {boolean} isVelToggled - A boolean indicating whether a non-zero vel of the same \n   *                                  pitch will turn a note off if it is turned on.\n   */\n  setVal(newNote, isVelToggled) {\n    let newState = this._getNewStateFromNewNote(newNote, isVelToggled);\n    this.setState(newState);\n  }\n\n  /* ==============================================================================================\n  *  INITIALIZATION METHODS\n  */\n\n  /**\n   * Initialize the options\n   * @override\n   * @private\n   */\n  _initOptions(o) {\n    // set the defaults\n    this.o = {\n      bottomNote: 48,\n      topNote: 71,\n      keyBorderColor: \"#484848\",\n      blackKeyColor: \"#484848\",\n      whiteKeyColor: \"#fff\",\n      blackKeyActiveColor: \"#999\",\n      whiteKeyActiveColor: \"#999\",\n      blackKeyHeightAspect: 0.6,\n      blackKeyWidthAspect: 0.66,\n      mode: \"polyphonic\",\n      orientation: \"horizontal\",\n      isEditable: true,\n      mouseSensitivity: 1.2\n    };\n\n    // override defaults with provided options\n    super._initOptions(o);\n  }  \n\n  /**\n   * Initialize state constraints\n   * @override\n   * @private\n   */\n  _initStateConstraints() {\n    const _this = this;\n\n    this.stateConstraints = new ConstraintSpec({\n      activeNotes: [{\n        pitch: new Constraint({ min: 0, max: 127 }),\n        vel: new Constraint({ min: 0, max: 127})\n      }]\n    });\n  }\n\n  /**\n   * Initializes the state.\n   * State is represented as an array of active notes, each of which is an object\n   * { pitch, vel }, where pitch is MIDI pitch (0 - 127) and vel is MIDI velocity\n   * (0 - 127). A vel of 0 is reported once for each note-off event, and not\n   * reported on subsequent callback notifications.\n   * @override\n   * @private\n   */\n  _initState() {\n    this.state = {\n      activeNotes: []\n    };\n\n    // Object representing the last note event that occured.\n    this.lastNoteEvent = {};\n  }\n\n  /**\n   * Initialize the svg elements\n   * @override\n   * @private\n   */\n  _initSvgEls() {\n    const _this = this;\n\n    this.svgEls = {\n      keys: []\n    };\n\n    this._update();\n  }\n\n  /**\n   * Updates the SVG elements. \n   * Adds or removes a number of SVG elements to match the current number of keys.\n   */\n   _updateSvgEls() {\n    let numKeys = this._getNumKeys();\n    \n    // add SVG elements representing keys to match current number of keys\n    for (let i = this.svgEls.keys.length; i < numKeys; ++i) {\n      this._addSvgKey();\n    }\n\n    // remove SVG elements representing keys to match current number of keys\n    for (let i = this.svgEls.keys.length; i > numKeys; ++i) {\n      this._removeSvgKey();\n    }\n  }\n\n  /**\n   * Initializes mouse and touch event handlers.\n   * @override\n   * @private\n   */\n  _initHandlers() {\n    const _this = this;\n\n    this.handlers = {\n      touch: function touch(ev) {\n        ev.preventDefault();\n\n        let touchVel = Math.ceil(127 * (_this._getKeyboardHeight() - _this._getRelativeY(ev.clientY)) / _this._getKeyboardHeight());\n        _this._touchKey(ev.target, touchVel);\n\n        for (let i = 0; i < _this.svgEls.keys.length; ++i) {\n          // activate / toggle a key on mouse enter\n          _this.svgEls.keys[i].addEventListener(\"mouseenter\", _this.handlers.touch);\n          _this.svgEls.keys[i].addEventListener(\"touchenter\", _this.handlers.touch);\n\n          _this.svgEls.keys[i].addEventListener(\"mouseup\", _this.handlers.release);\n          _this.svgEls.keys[i].addEventListener(\"touchend\", _this.handlers.release);\n        }\n      },\n      release: function release() {\n        for (let i = 0; i < _this.svgEls.keys.length; ++i) {\n          _this.svgEls.keys[i].removeEventListener(\"mouseenter\", _this.handlers.touch);\n          _this.svgEls.keys[i].removeEventListener(\"touchenter\", _this.handlers.touch);\n        }\n      }\n    };\n\n    for (let i = 0; i < this.svgEls.keys.length; ++i) {\n      this.svgEls.keys[i].addEventListener(\"mousedown\", this.handlers.touch);\n      this.svgEls.keys[i].addEventListener(\"touchdown\", this.handlers.touch);\n    }\n  }\n\n  /**\n   * \n   */\n  _touchKey(targetKey, vel) {\n    const _this = this;\n\n    let keyIdx = this.svgEls.keys.findIndex(key => key === targetKey);\n\n    let newNote = {\n      pitch: keyIdx + _this.o.bottomNote,\n      vel: vel \n    };\n\n    this.setVal(newNote, true);\n  }\n\n  /**\n   * Updates (redraws) component based on state.\n   * @override\n   * @private\n   */\n  _update() {\n    var x, y, width, height, fill, stroke;\n    let blackKeys = [];\n    \n    // an array of velocities representing all possible notes (vel 0 means note is off)\n    let notes = new Array(this._getNumKeys());\n    notes.fill(0);\n\n    // put value of 1 for all active notes in the note array\n    this.getState().activeNotes.forEach(activeNote => {\n      notes[activeNote.pitch - this.getOptions().bottomNote] = 1;  \n    });\n\n    this._updateSvgEls();\n\n    for (let keyIdx = 0, whiteKeyIdx = 0; keyIdx < this.svgEls.keys.length; ++keyIdx) {\n      let pitch = this._getPitchForKeyIdx(keyIdx);\n      let attr = {};\n\n      if (this._isWhiteKey(pitch)) {\n        attr.x = this._getWhiteKeyWidth() * whiteKeyIdx;\n        attr.y = 0;\n        attr.width = this._getWhiteKeyWidth();\n        attr.height = this._getKeyboardHeight();\n        attr.fill = (notes[keyIdx] === 0) ? \n            this.getOptions().whiteKeyColor\n          : this.getOptions().whiteKeyActiveColor;\n        attr.stroke = this.getOptions().keyBorderColor;\n\n        ++whiteKeyIdx;       \n      } else {\n        blackKeys.push(this.svgEls.keys[keyIdx]);\n\n        // black keys are offset by 2/3 of white key width, and are 2/3 width and height of black keys\n        attr.x = (this._getWhiteKeyWidth() * whiteKeyIdx) - ( this.getOptions().blackKeyWidthAspect * this._getWhiteKeyWidth() / 2 );\n        attr.y = 0;\n        attr.width = this.getOptions().blackKeyWidthAspect * this._getWhiteKeyWidth();\n        attr.height = this.getOptions().blackKeyHeightAspect * this._getKeyboardHeight();\n        attr.fill = (notes[keyIdx] === 0) ? \n            this.getOptions().blackKeyColor\n          : this.getOptions().blackKeyActiveColor;\n        attr.stroke = this.getOptions().keyBorderColor;\n      }\n\n      this._setKeyAttributes(keyIdx, attr);\n    }\n\n    // remove and reappend black keys so they are on top of the white keys\n    for (let i = 0; i < blackKeys.length; ++i) {\n      this.svg.removeChild(blackKeys[i]);\n      this.svg.appendChild(blackKeys[i]);\n    }\n  }\n\n  /* ===========================================================================\n  *  INTERNAL FUNCTIONALITY\n  */\n\n  /**\n   * Returns a newState object representing a new keyboard state based on a new note provided. \n   * @param {object} newNote - A note object of format { pitch: number, vel: number }.\n   * @param {number} newNote.pitch\n   * @param {number} newNote.vel\n   * @param {boolean} isVelToggled - A boolean indicating whether a non-zero vel of the same \n   *                                  pitch will turn a note off if it is turned on.\n   * @returns {object} An object representing the new state. \n   */\n  _getNewStateFromNewNote(newNote, isVelToggled) {\n    let newState = this.getState();\n    let noteIdx = newState.activeNotes.findIndex(note => note.pitch === newNote.pitch);\n    \n    if (noteIdx === -1) {\n      if (newNote.vel > 0) {\n        newState.activeNotes.push(newNote);\n      }\n    } else {\n      if (newNote.vel <= 0 || isVelToggled) {\n        newState.activeNotes.splice(noteIdx, 1);\n        newNote.vel = 0;\n      } else {\n        newState.activeNotes[noteIdx].vel = newNote.vel;\n      }\n    }\n\n    this.lastNoteEvent = newNote;\n\n    return newState;\n  }\n\n  /**\n   * Adds an SVG element representing a key.\n   */\n  _addSvgKey() {\n    let newKey = document.createElementNS(this.SVG_NS, \"rect\");\n    this.svg.appendChild(newKey);\n    this.svgEls.keys.push(newKey);\n    newKey.addEventListener(\"mousedown\", this.handlers.touch);\n    newKey.addEventListener(\"touchdown\", this.handlers.touch);\n  }\n\n  /**\n   * Removes an SVG element representing a key.\n   */\n  _removeSvgKey() {\n    let key = this.svgEls.keys[this.svgEls.keys.length - 1];\n\n    this.svg.removeChild(key);\n    key = null;\n    this.svgEls.keys.pop();\n  }\n\n  /* ===========================================================================\n  *  HELPER METHODS\n  */\n\n  /**\n   * Sets attributes for an SVG rectangle representing a key with the given index.\n   */\n  _setKeyAttributes(keyIdx, attr) {\n    this.svgEls.keys[keyIdx].setAttribute(\"x\", attr.x);\n    this.svgEls.keys[keyIdx].setAttribute(\"y\", attr.y);\n    this.svgEls.keys[keyIdx].setAttribute(\"width\", attr.width);\n    this.svgEls.keys[keyIdx].setAttribute(\"height\", attr.height);\n    this.svgEls.keys[keyIdx].setAttribute(\"fill\", attr.fill);\n    this.svgEls.keys[keyIdx].setAttribute(\"stroke\", attr.stroke);\n  }\n\n  /**\n   * Returns the width of the keyboard, taking orientation into account.\n   * If orientation is horizontal, width of the keyboard would equal\n   * width of the canvas. If orientation is vertical, width of the\n   * keyboard would equal the height of the canvas.\n   * @private\n   * @throws {Error} if o.orientation is not one of the allowed values.\n   */\n  _getKeyboardWidth() {\n    let orientation = this.getOptions().orientation;\n\n    if (orientation === \"horizontal\" || orientation === \"horizontal-mirrored\") {\n      return this._getWidth();\n    } else if (orientation === \"vertical\" || orientation === \"vertical-mirrored\") {\n      return this._getHeight();\n    } \n  }\n\n  /**\n   * Returns the height of the keyboard, taking orientation into account.\n   * If orientation is horizontal, height of the keyboard would equal\n   * height of the canvas. If orientation is vertical, height of the\n   * keyboard would equal the width of the canvas.\n   * @private\n   * @throws {Error} if o.orientation is not one of the allowed values.\n   */\n  _getKeyboardHeight() {\n    let orientation = this.getOptions().orientation;\n\n    if (orientation === \"horizontal\" || orientation === \"horizontal-mirrored\") {\n      return this._getHeight();\n    } else if (orientation === \"vertical\" || orientation === \"vertical-mirrored\") {\n      return this._getWidth();\n    } \n  }\n\n  /**\n   * Returns the MIDI note number for the given key number.\n   * @private\n   * @param {number} keyIdx - The index of the key to be queried.\n   * @returns {number} - MIDI note number for the given key number\n   */\n  _getPitchForKeyIdx(keyIdx) {\n    return this.getOptions().bottomNote + keyIdx;\n  }\n\n  /** \n   * Returns the total number of keys on the keyboard. \n   * @private\n   * @returns {number} - Total number of keys.\n   */\n  _getNumKeys() {\n    return (this.o.topNote - this.o.bottomNote) + 1;\n  }\n\n  /**  \n   * Returns the number of white keys on the keyboard.\n   * @private\n   * @returns {number} - Number of white keys. \n   */\n  _getNumWhiteKeys() {\n    let whiteKeyCount = 0;\n\n    for (let curNote = this.getOptions().bottomNote; curNote <= this.getOptions().topNote; ++curNote) {\n      if (this._isWhiteKey(curNote)) {\n        ++whiteKeyCount;\n      }\n    }\n\n    return whiteKeyCount;\n  }\n\n  /** \n   * Returns the width of each white key in px.\n   * @private\n   * @returns {number} - Width of each white key in px.\n   */\n  _getWhiteKeyWidth() {\n    return this._getKeyboardWidth() / this._getNumWhiteKeys();\n  }\n\n  /**\n   * Returns true if the given MIDI note number is a white key on the piano.\n   * @private\n   * @param {number} note - The MIDI note number for the given note. \n   * @returns {boolean} - True if the note is a white key, false if not.\n   */\n  _isWhiteKey(note) {\n    if (note % 12 === 0 || \n        note % 12 === 2 || \n        note % 12 === 4 || \n        note % 12 === 5 || \n        note % 12 === 7 || \n        note % 12 === 9 || \n        note % 12 === 11) {\n        return true;\n    } else {\n      return false;\n    }\n  }\n}\n\nexport default Keyboard;\n\n\n// WEBPACK FOOTER //\n// ./src/ui/keyboard.js","import Widget from \"ui/core/widget\";\nimport Constraint from \"util/constraint\";\nimport ConstraintSpec from \"util/constraint-def\";\n\n/**\n * Class representing an Dropmenu widget.\n * @class\n * @implements {Widget}\n */\nclass Dropmenu extends Widget {\n\n  /**\n   * @constructor\n   * @param {object} container - DOM container for the widget.\n   * @param {object} [o] - Options.\n   * @param {object} [o.menuItems=[]] - The items to populate the menu with.\n   * @param {string} [o.backgroundColor=\"#282828\"] - The background color.\n   * @param {string} [o.fontColor=\"#ccc\"] - The font color.\n   * @param {string} [o.fontSize=\"12px\"] - The font size.\n   * @param {string} [o.fontFamily=\"Arial\"] - The font family.\n   * @param {string} [o.menuItemFontSize=\"12px\"] - The font size for items in the opened drop-down menu.\n   * @param {string} [o.menuItemFontFamily=\"Arial\"] - The font family for items in the opened drop-down menu.\n   * @param {string} [o.selectedItemBackgroundColor=\"#f40\"] - The background cover for the selected (hovered) item in the opened drop-down menu.\n   * @param {string} [o.selectedItemFontColor=\"#fff\"] - The font color for the selected (hovered) item in the opened drop-down menu.\n   * @param {number} [o.menuItemHorizontalPadding=10] - Extra horizontal padding to add to each menu item.\n   * @param {number} [o.menuItemVerticalPadding=5] - Extra vertical padding to add to each menu item. \n   */\n  constructor(container, o) {\n    super(container, o);\n  }\n\n  /* ==============================================================================================\n  *  PUBLIC API\n  */\n\n  /**\n   * Returns the currently selected menu item index.\n   * @public @override\n   * @returns {number} - Index of the item currently selected.\n   */\n  getVal() {\n    return this.state.selectedItemIdx;\n  }\n\n  /**\n   * Returns the string representing the currently selected item.\n   * @public\n   * @returns {string} - The string representing the selected item.\n   */\n  getSelectedItem() {\n    return this.state.menuItems[this.state.selectedItemIdx];\n  }\n\n  /**\n   * Sets the currently selected menu item.\n   * Same as setVal(), but will not cause an observer callback trigger.\n   * @public @override\n   * @param {number} itemIdx - Index of the item to be selected.\n   */\n  setInternalVal(itemIdx) {\n    this.setInternalState({ selectedItemIdx: itemIdx });\n  }\n\n  /**\n   * Sets the currently selected menu item.\n   * Same as setInternalVal(), but will cause an observer callback trigger.\n   * @public @override\n   * @param {number} itemIdx - Index of the item to be selected.\n   */\n  setVal(itemIdx) {\n    this.setState({ selectedItemIdx: itemIdx });\n  }\n\n  /**\n   * Sets the selected menu item by index.\n   * Same as setInternalSelectionIdx(), but will cause an observer callback trigger.\n   * @param {number} itemIdx - Index of the item to be selected.\n   */\n  setSelectionIdx(itemIdx) {\n    this.setState({ selectedItemIdx: itemIdx });\n  }\n\n  /**\n   * Sets the selected menu item by index.\n   * Same as setSelectionIdx(), but will not cause an observer callback trigger.\n   * @param {number} itemIdx - Index of the item to be selected.\n   */\n  setInternalSelectionIdx(itemIdx) {\n    this.setInternalState({ selectedItemIdx: itemIdx });\n  }\n\n  /**\n   * Sets the selected menu item according to a string argument specifying which item to select.\n   * If the argument is not one of the menu items, the selection will not change.\n   * Same as setInternalSelectedItem(), but will cause and observer callback trigger.\n   * @param {string} item - The item to select\n   * @returns {number} - Index of the item selected.\n   */\n  setSelectedItem(item) {\n    let idx = this.state.menuItems.findIndex(menuItem => item === menuItem);\n\n    if (idx !== -1) {\n      this.setVal(idx);\n    } else {\n      idx = this.state.selectedItemIdx;\n    }\n\n    return idx;\n  }\n\n  /**\n   * Sets the selected menu item according to a string argument specifying which item to select.\n   * If the argument is not one of the menu items, the selection will not change.\n   * Same as setSelectedItem(), but will not cause and observer callback trigger.\n   * @param {string} item - The item to select\n   * @returns {number} - Index of the item selected.\n   */\n  setInternalSelectedItem(item) {\n    let idx = this.state.menuItems.findIndex(menuItem => item === menuItem);\n    \n    if (idx !== -1) {\n      this.setVal(idx);\n    } else {\n      idx = this.state.selectedItemIdx;\n    }\n\n    return idx;\n  }\n\n  /**\n   * Sets the list of available menu items.\n   * @public @override\n   * @param {array} menuItems - Array of menu items to use.\n   */\n  setMenuItems(menuItems) {\n    this.setState({ menuItems: menuItems});\n  }\n\n  /* ==============================================================================================\n  *  INITIALIZATION METHODS\n  */\n\n  /**\n   * Initializes the options.\n   * @private @override\n   */\n  _initOptions(o) {\n    // set the defaults\n    this.o = {\n      menuItems: [],\n      backgroundColor: \"#282828\",\n      fontColor: \"#ccc\",\n      fontSize: \"12px\",\n      fontFamily: \"Arial\",\n      menuItemFontSize: \"12px\",\n      menuItemFontFamily: \"Arial\",\n      menuItemVerticalPadding: 5, \n      menuItemHorizontalPadding: 10,\n      selectedItemBackgroundColor: \"#f40\",\n      selectedItemFontColor: \"#fff\",\n      mouseSensitivity: 1.2\n    };\n\n    // override defaults with provided options\n    super._initOptions(o);\n  }\n\n  /**\n   * Initializes state constraints.\n   * @private @override\n   */\n  _initStateConstraints() {\n    const _this = this;\n\n    this.stateConstraints = new ConstraintSpec({\n      menuItems: [new Constraint()],\n      selectedItemIdx: new Constraint(),\n      hasFocus: new Constraint()\n    });\n  }\n\n  /**\n   * Initializes the state.\n   * @private @override\n   */\n  _initState() {\n    this.state = {\n      menuItems: this.o.menuItems,\n      selectedItemIdx: 0,\n      hasFocus: false\n    };\n  }\n\n  /**\n   * Initializes the svg elements.\n   * @private @override\n   */\n  _initSvgEls() {\n    const _this = this;\n\n    /* The following components are used:\n     *  Panels are the background\n     *  Text is where the text lives\n     *  Overlays are transparent and are used to listen to mouse events\n     */\n    this.svgEls = {\n      menuTogglePanel: document.createElementNS(_this.SVG_NS, \"rect\"),\n      menuToggleText: document.createElementNS(_this.SVG_NS, \"text\"),\n      menuToggleOverlay: document.createElementNS(_this.SVG_NS, \"rect\"),\n      menuBodyCanvasContainer: document.createElement(\"div\"),\n      menuBodyCanvas: document.createElementNS(_this.SVG_NS, \"svg\"),\n      menuBodyPanel: document.createElementNS(_this.SVG_NS, \"rect\"),\n      menuItemPanels: [],\n      menuItemTextboxes: [],\n      menuItemOverlays: []\n    };\n\n    this.svg.appendChild(this.svgEls.menuTogglePanel);\n    this.svg.appendChild(this.svgEls.menuToggleText);\n    this.svg.appendChild(this.svgEls.menuToggleOverlay);\n\n    this.svgEls.menuToggleText.setAttribute(\"alignment-baseline\", \"middle\");\n\n    // menu body (the part that is hidden unless toggled)\n\n    this.svgEls.menuBodyCanvasContainer.style.position = \"relative\";\n    this.container.appendChild(this.svgEls.menuBodyCanvasContainer);\n    this.svgEls.menuBodyCanvas = document.createElementNS(_this.SVG_NS, \"svg\");\n    this.svgEls.menuBodyCanvasContainer.appendChild(this.svgEls.menuBodyCanvas);\n    this.svgEls.menuBodyCanvas.style.position = \"absolute\";\n    this.svgEls.menuBodyCanvas.style.transform = \"translateY(-5px)\";\n    this.svgEls.menuBodyCanvas.appendChild(this.svgEls.menuBodyPanel);\n\n    this._update();\n  }\n\n  /**\n   * Initializes mouse and touch event handlers.\n   * @private @override\n   */\n  _initHandlers() {\n    const _this = this;\n\n    this.handlers = {\n\n      touch: function touch(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        _this.handlers.focus(ev);\n      },\n\n      focus: function focus(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        _this.setInternalState({ hasFocus: true });\n\n        _this.svgEls.menuToggleOverlay.removeEventListener(\"mousedown\", _this.handlers.touch);\n        _this.svgEls.menuToggleOverlay.removeEventListener(\"touchstart\", _this.handlers.touch);\n        _this.svgEls.menuToggleOverlay.addEventListener(\"mousedown\", _this.handlers.blur);\n        _this.svgEls.menuToggleOverlay.addEventListener(\"touchstart\", _this.handlers.blur);\n       \n        document.body.addEventListener(\"mousedown\", _this.handlers.blur);\n        document.body.addEventListener(\"touchstart\", _this.handlers.blur);\n      },\n\n      blur: function blur(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        _this.setInternalState({ hasFocus: false });\n\n        _this.svgEls.menuToggleOverlay.removeEventListener(\"mousedown\", _this.handlers.blur);\n        _this.svgEls.menuToggleOverlay.removeEventListener(\"touchstart\", _this.handlers.blur);\n        _this.svgEls.menuToggleOverlay.addEventListener(\"mousedown\", _this.handlers.touch);\n        _this.svgEls.menuToggleOverlay.addEventListener(\"touchstart\", _this.handlers.touch);\n        document.body.removeEventListener(\"mousedown\", _this.handlers.blur);\n        document.body.removeEventListener(\"touchstart\", _this.handlers.blur);\n      },\n\n      mouseOverItem: function mouseOverItem(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        let targetOverlay = ev.target;\n        _this._mouseOverItem(targetOverlay);\n\n        targetOverlay.addEventListener(\"mouseleave\", _this.handlers.mouseLeaveItem);\n        targetOverlay.addEventListener(\"mouseup\", (ev) => {\n          _this.handlers.select(ev);\n          _this.handlers.blur(ev);\n        });\n        targetOverlay.addEventListener(\"touchend\", (ev) => {\n          _this.handlers.select(ev);\n          _this.handlers.blur(ev);\n        });\n        \n        document.body.removeEventListener(\"mousedown\", _this.handlers.blur);\n        document.body.removeEventListener(\"touchstart\", _this.handlers.blur);\n      },\n\n      mouseLeaveItem: function mouseLeaveItem(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        let targetOverlay = ev.target;   \n        _this._mouseLeaveItem(ev.target, false);\n\n        targetOverlay.removeEventListener(\"mouseleave\", _this.handlers.hoverOut);\n\n        document.body.addEventListener(\"mousedown\", _this.handlers.blur);\n        document.body.addEventListener(\"touchstart\", _this.handlers.blur);\n      },\n\n      select: function select(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        _this._selectItem(ev.target);\n      }\n    };\n\n    this.svgEls.menuToggleOverlay.addEventListener(\"mousedown\", this.handlers.touch);\n    this.svgEls.menuToggleOverlay.addEventListener(\"touchstart\", this.handlers.touch);\n  }\n\n  /**\n   * Updates (redraws) components based on state.\n   * @private @override\n   */\n  _update() {\n    const _this = this;\n\n    _this._updateEls();\n\n    for (let i = 0; i < _this.state.menuItems.length; ++i) {\n      _this.svgEls.menuItemTextboxes[i].textContent = _this.state.menuItems[i];\n    }\n\n    // Set attributes for the toggle area\n    this.svgEls.menuTogglePanel.setAttribute(\"fill\", _this.o.backgroundColor);\n    this.svgEls.menuTogglePanel.setAttribute(\"width\", _this._getWidth());\n    this.svgEls.menuTogglePanel.setAttribute(\"height\", _this._getHeight());\n\n    this.svgEls.menuToggleText.setAttribute(\"width\", _this._getWidth());\n    this.svgEls.menuToggleText.setAttribute(\"height\", _this._getHeight());\n    this.svgEls.menuToggleText.setAttribute(\"x\", 10);\n    this.svgEls.menuToggleText.setAttribute(\"y\", _this._getHeight() / 2);\n    this.svgEls.menuToggleText.setAttribute(\"fill\", _this.o.fontColor);\n\n    this.svgEls.menuToggleOverlay.setAttribute(\"fill\", \"transparent\");\n    this.svgEls.menuToggleOverlay.setAttribute(\"width\", _this._getWidth());\n    this.svgEls.menuToggleOverlay.setAttribute(\"height\", _this._getHeight());\n\n    this.svgEls.menuToggleText.textContent = _this.state.menuItems[_this.state.selectedItemIdx];\n    \n    // Set attributes for the menu body\n    if (this.state.hasFocus) {\n      this.svgEls.menuBodyCanvas.style.display = \"inline-block\";\n\n      // reappend the svg canvas for the menu body so that it appears on top of other elements\n      this.svgEls.menuBodyCanvasContainer.removeChild(this.svgEls.menuBodyCanvas);\n      this.svgEls.menuBodyCanvasContainer.appendChild(this.svgEls.menuBodyCanvas);\n\n      let menuItemDims = _this._calcMenuItemDims();\n      let menuDims = {\n        height: menuItemDims.height * _this.state.menuItems.length, \n        width: menuItemDims.width\n      };\n\n      this.svgEls.menuBodyCanvas.setAttribute(\"width\", menuDims.width);\n      this.svgEls.menuBodyCanvas.setAttribute(\"height\", menuDims.height);\n      this.svgEls.menuBodyCanvas.style.left = 0;\n\n      this.svgEls.menuBodyPanel.setAttribute(\"width\", menuDims.width);\n      this.svgEls.menuBodyPanel.setAttribute(\"height\", menuDims.height);\n      this.svgEls.menuBodyPanel.setAttribute(\"x\", 0);\n      this.svgEls.menuBodyPanel.setAttribute(\"y\", 0);\n      this.svgEls.menuBodyPanel.setAttribute(\"fill\", this.o.backgroundColor);\n\n      for (let i = 0; i < this.state.menuItems.length; ++i) {\n        let curPanel = this.svgEls.menuItemPanels[i];\n        let curTextbox = this.svgEls.menuItemTextboxes[i];\n        let curOverlay = this.svgEls.menuItemOverlays[i];\n\n        curPanel.setAttribute(\"x\", 0);\n        curPanel.setAttribute(\"y\", i * menuItemDims.height);\n        curPanel.setAttribute(\"width\", menuItemDims.width);\n        curPanel.setAttribute(\"height\", menuItemDims.height);\n        curPanel.setAttribute(\"fill\", \"transparent\");\n        curTextbox.setAttribute(\"alignment-baseline\", \"middle\");\n        curTextbox.setAttribute(\"fill\", _this.o.fontColor);\n        curTextbox.setAttribute(\"x\", 10);\n        curTextbox.setAttribute(\"y\", ((i + 1) * menuItemDims.height) - (menuItemDims.height / 2));\n        curOverlay.setAttribute(\"x\", 0);\n        curOverlay.setAttribute(\"y\", i * menuItemDims.height);\n        curOverlay.setAttribute(\"width\", menuItemDims.width);\n        curOverlay.setAttribute(\"height\", menuItemDims.height);\n        curOverlay.setAttribute(\"fill\", \"transparent\");  \n      }\n    } else {\n      this.svgEls.menuBodyCanvas.style.display = \"none\";\n    }\n  }\n\n  /**\n   * Updates elements to match SVG representation with the state.\n   * @private\n   */\n  _updateEls() {\n    const _this = this;\n\n    for (let i = this.svgEls.menuItemTextboxes.length; i < this.state.menuItems.length; ++i) {\n      _this._addSvgMenuItem();\n    }\n\n    for (let i = this.state.menuItems.length; i > this.svgEls.menuItemTextboxes.length ; --i) {\n      _this._removeSvgMenuItem();\n    }\n  }\n\n  /* ==============================================================================================\n  *  INTERNAL FUNCTIONALITY METHODS\n  */\n\n  /**\n   * Handles mouse over event for menu item.\n   * @private\n   * @param {SvgElement} targetOverlay - The overlay of the item being hovered.\n   */\n  _mouseOverItem(targetOverlay) {\n    const _this = this;\n\n    let idx = _this.svgEls.menuItemOverlays.findIndex(overlay => overlay === targetOverlay);\n\n    if (idx !== -1) {\n      let targetPanel = _this.svgEls.menuItemPanels[idx];\n      let targetTextbox = _this.svgEls.menuItemTextboxes[idx];\n\n      targetPanel.setAttribute(\"fill\", _this.o.selectedItemBackgroundColor);\n      targetTextbox.setAttribute(\"fill\", _this.o.selectedItemFontColor);\n    }\n  }\n\n  /**\n   * Handles mouse leave event for menu item.\n   * @private\n   * @param {SvgElement} targetOverlay - The overlay of the target item.\n   */\n  _mouseLeaveItem(targetOverlay) {\n    const _this = this;\n    \n    let idx = _this.svgEls.menuItemOverlays.findIndex(overlay => overlay === targetOverlay);\n\n    if (idx !== -1) {\n      let targetPanel = _this.svgEls.menuItemPanels[idx];\n      let targetTextbox = _this.svgEls.menuItemTextboxes[idx];\n\n      targetPanel.setAttribute(\"fill\", \"transparent\");\n      targetTextbox.setAttribute(\"fill\", _this.o.fontColor);      \n    }\n  }\n\n  /**\n   * Adds svg elements representing a menu item.\n   * @private\n   */\n  _addSvgMenuItem() {\n    const _this = this;\n\n    let newItemText = document.createElementNS(this.SVG_NS, \"text\");\n    let newItemPanel = document.createElementNS(this.SVG_NS, \"rect\");\n    let newItemOverlay = document.createElementNS(this.SVG_NS, \"rect\");\n    \n    this.svgEls.menuItemTextboxes.push(newItemText);\n    this.svgEls.menuItemPanels.push(newItemPanel);\n    this.svgEls.menuItemOverlays.push(newItemOverlay);\n\n    this.svgEls.menuBodyCanvas.appendChild(newItemPanel);\n    this.svgEls.menuBodyCanvas.appendChild(newItemText);\n    this.svgEls.menuBodyCanvas.appendChild(newItemOverlay);\n\n    newItemOverlay.addEventListener(\"mouseenter\", (ev) => { _this.handlers.mouseOverItem(ev); });\n  }\n\n  /**\n   * Removes svg elements representing a menu item.\n   * @private\n   */\n  _removeSvgMenuItem() {\n    let targetItemTexbox = this.svgEls.menuItemTextboxes.pop();\n    let targetItemPanel = this.svgEls.menuItemPanels.pop();\n    let targetItemOverlay = this.svgEls.menuItemPanels.pop();\n\n    this.svgEls.menuBodyCanvas.removeChild(targetItemTexbox);\n    this.svgEls.menuBodyCanvas.removeChild(targetItemPanel);\n    this.svgEls.menuBodyCanvas.removeChild(targetItemOverlay);\n\n    targetItemTexbox = null;\n    targetItemPanel = null;\n    targetItemOverlay = null;\n  }\n\n  /**\n   * Calculate the height of each menu item.\n   * @private\n   * @returns {number} - Height in px.\n   */\n  _calcMenuItemDims() {\n    let maxHeight = 0;\n    let maxWidth = 0;\n    \n    this.svgEls.menuItemTextboxes.forEach(item => {\n      let bbox = item.getBoundingClientRect();\n      maxHeight = maxHeight > bbox.height ? maxHeight : bbox.height;\n      maxWidth  = maxWidth > bbox.width ? maxWidth : bbox.width;\n    });\n\n    maxWidth = Math.max(maxWidth, this._getWidth());\n\n    // add some extra padding\n    maxHeight += this.o.menuItemVerticalPadding;\n    maxWidth += this.o.menuItemHorizontalPadding;\n\n    return { width: maxWidth, height: maxHeight };\n  }\n\n  /**\n   * Marks a menu element as selected.\n   * @private\n   * @param {SvgElement} targetOverlay \n   */\n  _selectItem(targetOverlay) {\n    const _this = this;\n\n    let idx = _this.svgEls.menuItemOverlays.findIndex(overlay => overlay === targetOverlay);\n\n    if (idx !== -1) {\n      _this.setState({ selectedItemIdx: idx });\n    }\n  }\n\n}\n\nexport default Dropmenu;\n\n\n// WEBPACK FOOTER //\n// ./src/ui/dropmenu.js","import Widget from \"ui/core/widget\";\nimport Constraint from \"util/constraint\";\nimport ConstraintSpec from \"util/constraint-def\";\n\n/**\n * Class representing a Multislider widget.\n * @class\n * @implements {Widget}\n */\nclass Multislider extends Widget {\n\n  /**\n   * @constructor\n   * @param {object} container - DOM container for the widget.\n   * @param {object} [o] - Options.\n   * @param {number} [o.numSliders=10] - Number of sliders.\n   * @param {number} [o.minVal=0] - Minimum slider value.\n   * @param {number} [o.maxVal=127] - Maximum slider value.\n   * @param {array<string>} [o.sliderColors=[\"#000\"]] - Slider colors, specified as an array of color values.\n   *                                                    e.g. to get a black-white-black-white zebra pattern, specify\n   *                                                    ['black', 'white']\n   * @param {string} [o.backgroundColor=\"#fff\"] - Background color.\n   */\n  constructor(container, o) {\n    super(container, o);\n  }\n\n  /* ===========================================================================\n  *  INITIALIZATION METHODS\n  */\n\n  /**\n   * Initialize the options\n   * @override\n   * @protected\n   */\n  _initOptions(o) {\n    // set the defaults\n    this.o = {\n      numSliders: 10,\n      minVal: 0,\n      maxVal: 127,\n      sliderColors: [\"#f40\", \"#f50\"],\n      backgroundColor: \"#fff\",\n      mouseSensitivity: 1.2\n    };\n\n    // override defaults with provided options\n    super._initOptions(o);\n  }\n\n  /**\n   * Initialize state constraints\n   * @override\n   * @protected\n   */\n  _initStateConstraints() {\n    const _this = this;\n\n    this.stateConstraints = new ConstraintSpec({\n      sliderVals: [new Constraint({ \n        min: _this.o.minVal, \n        max: _this.o.maxVal,\n        transform: (num) => num.toFixed(0) \n      })]\n    });\n  }\n\n  /**\n   * Initialize state\n   * @override\n   * @protected\n   */\n  _initState() {\n    this.state = {\n      sliderVals: []\n    };\n  }\n\n  /**\n   * Initialize the svg elements\n   * @override\n   * @protected\n   */\n  _initSvgEls() {\n    const _this = this;\n\n    this.svgEls = {\n      panel: document.createElementNS(this.SVG_NS, \"rect\"),\n      sliders: [],\n      sliderPanels: []\n    };\n\n    this._appendSvgEls();\n    this._update();\n  }\n\n  /**\n   * Initialize mouse and touch event handlers\n   * @override\n   * @protected\n   */\n  _initHandlers() {\n    const _this = this;\n\n    this.handlers = {\n      touch: function touch(ev) {\n        ev.preventDefault();\n\n        let y = _this._getHeight() - _this._getRelativeY(ev.clientY);\n\n        _this._setSliderVal(ev.target, y);\n\n        for (let i = 0; i < _this.svgEls.sliderPanels.length; ++i) {\n          _this.svgEls.sliderPanels[i].addEventListener(\"mousemove\", _this.handlers.move);\n          _this.svgEls.sliderPanels[i].addEventListener(\"touchmove\", _this.handlers.move);\n\n        }\n\n        document.addEventListener(\"mouseup\", _this.handlers.release);\n        document.addEventListener(\"touchend\", _this.handlers.release);\n      },\n\n      move: function move(ev) {\n        ev.preventDefault();\n              \n        let y = _this._getHeight() - _this._getRelativeY(ev.clientY);\n        _this._setSliderVal(ev.target, y);\n      },\n\n      release: function release(ev) {\n        ev.preventDefault();\n\n        for (let i = 0; i < _this.svgEls.sliderPanels.length; ++i) {\n          _this.svgEls.sliderPanels[i].removeEventListener(\"mousemove\", _this.handlers.move);\n          _this.svgEls.sliderPanels[i].removeEventListener(\"touchmove\", _this.handlers.move);\n        }\n      }\n    };\n\n    for (let i = 0; i < this.svgEls.sliderPanels.length; ++i) {\n      this.svgEls.sliderPanels[i].addEventListener(\"mousedown\", this.handlers.touch);\n      this.svgEls.sliderPanels[i].addEventListener(\"touchstart\", this.handlers.touch);\n    }\n  }\n\n  /**\n   * Update (redraw) component based on state.\n   * @override\n   * @protected\n   */\n  _update() {\n    const _this = this;\n\n    _this._updateEls();\n  \n    for (let i = 0; i < this.o.numSliders; ++i) {\n      let sliderPos = _this._calcSliderPos(i);\n\n      this.svgEls.sliders[i].setAttribute(\"x\", sliderPos.x);\n      this.svgEls.sliders[i].setAttribute(\"y\", sliderPos.y);\n      this.svgEls.sliders[i].setAttribute(\"width\", _this._calcSliderWidth());\n      this.svgEls.sliders[i].setAttribute(\"height\", _this._calcSliderHeight(i));\n      this.svgEls.sliders[i].setAttribute(\"fill\", this.o.sliderColors[i % this.o.sliderColors.length]);\n\n      this.svgEls.sliderPanels[i].setAttribute(\"x\", sliderPos.x);\n      this.svgEls.sliderPanels[i].setAttribute(\"y\", 0);\n      this.svgEls.sliderPanels[i].setAttribute(\"width\", _this._calcSliderWidth());\n      this.svgEls.sliderPanels[i].setAttribute(\"height\", _this._getHeight());\n      this.svgEls.sliderPanels[i].setAttribute(\"fill\", \"transparent\");\n    }\n\n    // set background panel color\n    this.svgEls.panel.setAttribute(\"x\", 0);\n    this.svgEls.panel.setAttribute(\"y\", 0);\n    this.svgEls.panel.setAttribute(\"width\", _this._getWidth());\n    this.svgEls.panel.setAttribute(\"height\", _this._getHeight());\n    this.svgEls.panel.setAttribute(\"fill\", this.o.backgroundColor);\n  }\n\n  /**\n   * Updates the SVG elements and state containers. \n   * Adds or removes a number of SVG elements and state containers to match the current number of sliders.\n   * @private\n   */\n  _updateEls() {\n    let numSliders = this.o.numSliders;\n\n    // add SVG elements representing sliders to match current number of sliders\n    for (let i = this.state.sliderVals.length; i < numSliders; ++i) {\n      this.state.sliderVals.push(this.o.minVal);\n      this._addSvgSlider();\n    }\n\n    // remove SVG elements representing sliders to match current number of sliders\n    for (let i = this.state.sliderVals.length; i > numSliders; --i) {\n      this.state.sliderVals.pop();\n      this._removeSvgSlider();\n    }\n  }\n\n  /* ===========================================================================\n  *  PUBLIC API\n  */\n\n  /**\n   * Get public representation of the state.\n   * @abstract\n   * @public\n   * @returns {array} - An array of slider values.\n   */\n  getVal() {\n    return this.getState().sliderVals;\n  }\n\n  /**\n   * Set the current state in a format specific to each widget.\n   * Same as setVal(), but will not cause an observer callback trigger.\n   * @abstract @public\n   * @param {array} newSliderVals - An array representing the new slider values\n   */\n  setInternalVal(newSliderVals) {\n    let newState = {\n      sliderVals: newSliderVals\n    };\n    this.setInternalState(newState);\n  }\n\n  /**\n   * Set the current state in a format specific to each widget.\n   * Same as setInternalVal(), but will cause an observer callback trigger.\n   * @abstract @public\n   * @param {array} newSliderVals - An array representing the new slider values\n   */\n  setVal(newSliderVals) {\n    let newState = {\n      sliderVals: newSliderVals\n    };\n    this.setState(newState);\n  }\n\n  /* ===========================================================================\n  *  HELPER METHODS\n  */\n\n  /**\n   * Adds an svg element representing a slider.\n   * @private \n   */\n  _addSvgSlider() {\n    let _this = this;\n\n    let newSlider = document.createElementNS(this.SVG_NS, \"rect\");\n    let newSliderPanel = document.createElementNS(this.SVG_NS, \"rect\");\n    this.svg.appendChild(newSlider);\n    this.svg.appendChild(newSliderPanel);\n    this.svgEls.sliders.push(newSlider);\n    this.svgEls.sliderPanels.push(newSliderPanel);\n\n    newSliderPanel.addEventListener(\"mousedown\", _this.handlers.touch);\n    newSliderPanel.addEventListener(\"touchstart\", _this.handlers.touch);\n  }\n\n  /**\n   * Remove an SVG slider element.\n   * @private \n   */\n  _removeSvgSlider() {\n    let targetSlider = this.svgEls.sliders.pop();\n    let targetSliderPanel = this.svgEls.sliderPanels.pop();\n    this.svg.removeChild(targetSliderPanel);\n    this.svg.removeChild(targetSlider);\n    targetSlider = null;\n    targetSliderPanel = null;\n  }\n\n  /**\n   * Calculate the width of each slider.\n   * Each slider's width is width of multislider / number of sliders.\n   * @private\n   * @returns {number} - Width of each slider in px. \n   */\n  _calcSliderWidth() {\n    return this._getWidth() / this.o.numSliders;\n  }\n\n  /**\n   * Calculate the position for a given slider.\n   * @private\n   * @param {number} idx - Index of the slider (left to right).\n   * @returns {object} - Object representing the {x, y} position.\n   */\n  _calcSliderPos(idx) {\n    const _this = this;\n\n    return {\n      x: _this._calcSliderWidth() * idx, \n      y: _this._getHeight() - _this._calcSliderHeight(idx)\n    };\n  }\n\n  /**\n   * Calculate the slider height.\n   * @private\n   * @param {number} idx - Index of the slider.\n   * @returns {number} - Height of the slider in px.\n   */\n  _calcSliderHeight(idx) {\n    return (this.state.sliderVals[idx] / (this.o.maxVal - this.o.minVal)) * this._getHeight(); \n  }\n\n  /**\n   * Set value for a slider based on y position of a click event.\n   * @param {object} targetSliderPanel - The panel that registered the event. \n   * @param {number} y - Y-position of the event. \n   */\n  _setSliderVal(targetSliderPanel, y) {\n    const _this = this;\n    \n    let targetIdx = this.svgEls.sliderPanels.findIndex(sliderPanel => sliderPanel === targetSliderPanel);\n    let newVal = (y / (this._getHeight())) * (this.o.maxVal - this.o.minVal) + this.o.minVal;\n\n    let newState = {\n      sliderVals: _this.state.sliderVals.map((val, idx) => {\n        return (idx === targetIdx) ? newVal : val;\n      })\n    };\n\n    this.setState(newState);\n  }\n}\n\nexport default Multislider;\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/multislider.js","import Widget from \"ui/core/widget\";\nimport Constraint from \"util/constraint\";\nimport ConstraintSpec from \"util/constraint-def\";\n\n/**\n * Class representing a Volume Meter widget.\n * @class\n * @implements {Widget}\n */\nclass Meter extends Widget {\n\n  /**\n   * @constructor\n   * @param {object} container - DOM container for the widget.\n   * @param {AudioContext} audioContext - The audio context to be used.\n   * @param {object} [o] - Options object.\n   * @param {string} [o.backgroundColor=\"#282828\"] - The background color. \n   * @param {number} [o.initAmplitude=0] - The initial amplitude to be displayed (range of 0. - 1.)\n   */\n  constructor(container, audioCtx, o) {\n    o = o || {};\n\n    super(container, o);\n\n    // remove the svg since we are using canvas here\n    this.container.removeChild(this.svg);\n    this.svg = null;\n\n    this._initCanvasElements();\n    this._initAudioModules(audioCtx);\n    this._initOptions(o);\n  }\n\n  /* ===========================================================================\n  *  INITIALIZATION METHODS\n  */\n\n  /**\n   * Initialize the options.\n   * @override\n   * @private\n   */\n  _initOptions(o) {\n    // set the defaults\n    this.o = {\n      backgroundColor: \"#282828\",\n      initAmplitude: 0\n    };\n\n    // override defaults with provided options\n    super._initOptions(o);\n  }\n\n  /**\n   * Initialize the audio modules necessary to analyse the volume.\n   * @param {AudioContext} audioCtx - The audio context to use.\n   */\n  _initAudioModules(audioCtx) {\n    const _this = this;\n\n    this.audioCtx = audioCtx;\n    \n    // keep track of audio values\n    this.amplitude = 0;\n    this.prevAmplitude = 0;\n    this.peak = 0;\n    this.peakSetTime = audioCtx.currentTime;\n    \n    // create the script processor\n    // TODO: ScriptProcessorNode is soon to be derpecated and replaced by AudioWorker\n    this.scriptProcessor = this.audioCtx.createScriptProcessor(512, 1, 1);\n    this.scriptProcessor.connect(this.audioCtx.destination);\n    this.scriptProcessor.onaudioprocess = function(e) {\n      _this.amplitude = _this._calcAmplitude(e.inputBuffer.getChannelData(0));\n      _this.peak = _this._calcPeak();\n    };\n\n    this.input = this.scriptProcessor;\n  }\n\n  /**\n   * Initialize the canvas elements.\n   * @private\n   */\n  _initCanvasElements() {\n    if (this.canvas === undefined) {\n      this.canvas = document.createElement(\"canvas\");\n      this.container.appendChild(this.canvas);\n      this.ctx = this.canvas.getContext(\"2d\");\n    }\n  \n    let containerDims = this.container.getBoundingClientRect();\n    \n    this.canvas.setAttribute(\"width\", containerDims.width);\n    this.canvas.setAttribute(\"height\", containerDims.height);\n\n    this.ledGradient = this.ctx.createLinearGradient(0, this.canvas.height, 0, 0);\n    this.ledGradient.addColorStop(0, 'green');\n    this.ledGradient.addColorStop(0.6, 'lightgreen');\n    this.ledGradient.addColorStop(0.8, 'yellow');\n    this.ledGradient.addColorStop(1, 'red');\n\n    this._update();\n  }\n\n  /**\n   * Update (redraw) component based on state.\n   * @override\n   * @private\n   */\n  _update() {\n    const _this = this;\n\n    let containerDims = this.container.getBoundingClientRect();\n    let width = containerDims.width;\n    let height = containerDims.height;\n\n    redraw();\n\n    function redraw() {\n      let ledHeight = height * _this.amplitude;   \n      let peakYPos = height * _this.peak;\n\n      _this.ctx.clearRect(0, 0, width, height);\n      \n      // draw the background\n      _this.ctx.fillStyle = _this.o.backgroundColor;\n      _this.ctx.fillRect(0, 0, width, height);\n\n      // draw the led\n      _this.ctx.fillStyle = _this.ledGradient;\n      _this.ctx.fillRect(0, height - ledHeight, width, ledHeight);\n\n      // draw the peak\n      _this.ctx.fillStyle = _this.ledGradient;\n      _this.ctx.fillRect(0, peakYPos, width, 10);\n      \n      window.requestAnimationFrame(redraw);\n    } \n  }\n\n  /* ===========================================================================\n  *  PUBLIC API\n  */\n\n  /**\n   * Recieve audio from a source.\n   * @param {AudioNode} audioSource - The audio source to connect.\n   */\n  receiveAudioFrom(audioSource) {\n    audioSource.connect(this.scriptProcessor);\n  }\n\n  /* ===========================================================================\n  *  HELPER METHODS\n  */\n\n  /**\n   * Calculate the amplitude for a given audio buffer\n   * @param {Float32Array} buffer\n   */\n  _calcAmplitude(buffer) {\n    let sum = 0;\n    \n    for (let i = 0; i < buffer.length; ++i) {\n      sum += buffer[i] * buffer[i];\n    }\n\n    return Math.sqrt(sum / buffer.length); \n  }\n\n  /**\n   * Calculate the current peak\n   */\n  _calcPeak() {\n\n    // calculate the peak position\n    // special cases - peak = -1 means peak expired and waiting for amplitude to rise\n    // peak = 0 means amplitude is rising, waiting for peak\n    if (this.amplitude < this.prevAmplitude) {\n      this.peak = this.prevAmplitude;\n      this.peakSetTime = this.audioCtx.currentTime;\n    } else if (this.amplitude > this.prevAmplitude) {\n      this.peak = 0;\n    }\n\n    // draw the peak for 2 seconds, then remove it\n    if (this.audioCtx.currentTime - this.peakSetTime > 2 && this.peak !== 0) {\n      this.peak = -1;\n    }\n\n    this.prevAmplitude = this.amplitude;\n  }\n}\n\nexport default Meter;\n\n\n// WEBPACK FOOTER //\n// ./src/ui/meter.js","import WidgetDial from \"ui/dial\";\nimport EnvelopeGraph from \"ui/graph\";\nimport Keyboard from \"ui/keyboard\";\nimport Multislider from \"ui/multislider\";\nimport Dropmenu from \"ui/dropmenu\";\nimport Slider from \"ui/slider\";\nimport Meter from \"ui/meter\";\nimport Numberbox from \"ui/numberbox\";\n\n/** Dial */\nlet dialContainer = document.getElementById(\"dial\");\nlet dialDisplay = dialContainer.nextElementSibling;\nlet dial = new WidgetDial(dialContainer);\ndial.addObserver((state) => {\n  dialDisplay.innerHTML = state;\n});\ndial.setVal(300);\n\n/** Graph */\nlet envelopeGraphContainer = document.getElementById(\"graph\");\nlet envelopeGraphDisplay = document.getElementById(\"graph-display\");\nlet envelopeGraph = new EnvelopeGraph(envelopeGraphContainer);\nenvelopeGraph.addObserver(function(state) {\n  envelopeGraphDisplay.innerHTML = state.map((xyPair) => \" [\" + xyPair[0] + \", \" + xyPair[1] + \"]\");\n});\nenvelopeGraph.setVal([[0.0, 0.0],[5.3, 65.9],[10.7, 37.3],[16.5, 26.5],[26.0, 37.9],[35.8, 17.2],\n  [45.3, 69.2],[49.8, 53.9],[53.3, 27.2],[61.3, 15.9],[69.3, 25.9],[74.7, 39.9],[79.5, 47.9],\n  [83.2, 33.9],[86.2, 25.9],[91.0, 19.2],[92.0, 28.5],[93.0, 44.5],[97.3, 81.9],[100.0, 0.0]]\n);\n\n/** Keyboard */\nlet keyboardContainer = document.getElementById(\"keyboard\");\nlet keyboardDisplay = document.getElementById(\"keyboard-display\");\nkeyboardContainer.style.backgroundColor = \"red\";\nlet keyboard = new Keyboard(keyboardContainer, {\n  bottomNote: 36,\n  topNote: 83\n});\nkeyboard.addObserver(function(note) {\n  keyboardDisplay.innerHTML = \"Pitch: \" + note.pitch + \" Vel: \" + note.vel + \"<br>\" +\n    \"Active Notes: \" + keyboard.getActiveNotes().map(an => \"[ \" + an[0] + \", \" + an[1] + \" ]\");\n});\nkeyboard.setVal({pitch: 60, vel: 100});\nkeyboard.setVal({pitch: 64, vel: 100});\nkeyboard.setVal({pitch: 67, vel: 100});\n\n\n/** Multislider */\nlet multisliderContainer = document.getElementById(\"multislider\");\nlet multisliderDisplay = document.getElementById(\"multislider-display\");\nlet multislider = new Multislider(multisliderContainer, {});\nmultislider.addObserver(function(sliderVals) {\n  multisliderDisplay.innerHTML = sliderVals.map(val => \" \" + val);\n});\nmultislider.setState({sliderVals: [10, 50, 97, 81, 119, 81, 26, 114, 74, 47]});\n\n/** Slider */\nlet sliderContainer = document.getElementById(\"slider\");\nlet sliderDisplay = document.getElementById(\"slider-display\");\nlet slider = new Slider(sliderContainer, {});\nslider.addObserver(function(sliderVal) {\n  sliderDisplay.innerHTML = sliderVal;\n});\nslider.setVal(30);\n\n/** Meter */\nlet meterContainer = document.getElementById(\"meter\");\nlet meterDisplay = document.getElementById(\"meter-display\");\n\nlet audioCtx = new AudioContext();\n\nlet meter = new Meter(meterContainer, audioCtx, {});\n\nlet osc = audioCtx.createOscillator();\nlet lfo1 = audioCtx.createOscillator();\nlet lfo2 = audioCtx.createOscillator();\nlet amp1 = audioCtx.createGain();\nlet amp2 = audioCtx.createGain();\nlet amp3 = audioCtx.createGain();\n\nlfo1.frequency.value = 0.5;\nlfo2.frequency.value = 0.1;\namp3.gain.value = 0.5;\nosc.frequency.value = 220;\n\nlfo1.connect(amp1.gain);\nlfo2.connect(amp1);\namp1.connect(amp2.gain);\nosc.connect(amp2);\namp2.connect(amp3);\nmeter.receiveAudioFrom(amp3);\n\nlfo1.start();\nlfo2.start();\nosc.start();\n\n/** Dropmenu */\nlet dropmenuContainer = document.getElementById(\"dropmenu\");\nlet dropmenuDisplay = document.getElementById(\"dropmenu-display\");\nlet dropmenu = new Dropmenu(dropmenuContainer, {});\ndropmenu.setMenuItems([\"Zero\", \"One\", \"Two\", \"Three\", \"Four\", \"Five\"]);\ndropmenu.addObserver(function(selectedItem) {\n  dropmenuDisplay.innerHTML = \"Current selection: \" + selectedItem;\n});\n\n/** Numberbox */\nlet numberboxContainer = document.getElementById(\"numberbox\");\nlet numberboxDisplay = document.getElementById(\"numberbox-display\");\nlet numberbox = new Numberbox(numberboxContainer, {});\nnumberbox.addObserver(function(val) {\n  numberboxDisplay.innerHTML = val;\n});\n\n\n// WEBPACK FOOTER //\n// ./doc/ui/ui-doc.js"],"sourceRoot":""}